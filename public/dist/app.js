webpackJsonp([0],[function(e,t,i){"use strict";i(1),i(3),i(4),i(25),i(44),i(45)},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){return e.replace(P,"")}function o(e){try{return(new XMLSerializer).serializeToString(e)}catch(t){try{return e.xml}catch(e){alert("Xmlserializer not supported")}}return!1}function r(e){var t="";return e.contents().each(function(){t+=o(this)}),t}function s(){return Math.floor(1e10*Math.random()).toString()}function l(e){return e.replace(S,"")}function d(e){if(e.attributes)for(var t=0;t<e.attributes.length;t++){var i=e.attributes[t];i.nodeValue&&(i.nodeValue=l(i.nodeValue))}if(e.childNodes)for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];1==n.nodeType?d(n):3==n.nodeType&&n.nodeValue&&(n.nodeValue=l(n.nodeValue))}}function u(e){var t,i,n=e.length;if(n)for(;--n;)i=Math.floor(Math.random()*(n+1)),t=e[i],e[i]=e[n],e[n]=t;return e}function c(e,t){return x.default.isNone(e)?NaN:parseFloat(e.toPrecision(t))}function g(e){var t=parseFloat(e);if(isNaN(t))return 0;var i=t.toExponential().toString(),n=i.match(M);if(x.default.isNone(n))return x.default.warn("Number didn't parse correctly in countSigFigs: "+e,!x.default.isNone(n)),e.toString().match(E).length;var t=n[1];return t.match(E).length}function f(e){e=$(e);var t=document.createElement("canvas"),i=$(t);return i.attr("id",e.attr("id")),e.after(i),e.remove(),t}function h(e){return e?e.toLowerCase().replace(/ /g,"_").replace(/[^_a-z0-9]/g,""):(console.log("WARNING: blank data key text was specified"),null)}function p(){var e=x.default.Object.create({value:0}),t=x.default.Object.create({from:e,valueBinding:ConditionalBinding.from("from.value").pauseIfTrue("pausingProperty"),pausingProperty:!1});x.default.assert("",0==e.get("value")),x.default.assert("",0==t.get("value")),x.default.run(function(){e.set("value",1)}),x.default.assert("",1==e.get("value")),x.default.assert("",1==t.get("value")),x.default.run(function(){t.set("value",2)}),x.default.assert("",2==e.get("value")),x.default.assert("",2==t.get("value")),x.default.run(function(){t.set("pausingProperty",!0)}),x.default.assert("",2==e.get("value")),x.default.assert("",2==t.get("value")),x.default.run(function(){e.set("value",3)}),x.default.assert("",3==e.get("value")),x.default.assert("Target shouldn't have updated from",2==t.get("value")),x.default.run(function(){t.set("value",4)}),x.default.assert("Source shouldn't have updated from to",3==e.get("value")),x.default.assert("",4==t.get("value")),x.default.run(function(){e.set("value",5)}),x.default.assert("",5==e.get("value")),x.default.assert("",4==t.get("value")),x.default.run(function(){t.set("pausingProperty",!1)}),x.default.assert("",5==e.get("value")),x.default.assert("From was set latest, so to should be overwritten by sync",5==t.get("value")),x.default.run(function(){e.set("value",6)}),x.default.assert("",6==e.get("value")),x.default.assert("",6==t.get("value")),x.default.run(function(){e.set("value",7)}),x.default.assert("",7==e.get("value")),x.default.assert("",7==t.get("value"))}function m(){var e=x.default.Object.create({value:0}),t=x.default.Object.create({from:e,valueBinding:ConditionalBinding.from("from.value").pauseIfTrue("pausingProperty").onlyPause("from").onResumeSetBothTo("from"),pausingProperty:!1});x.default.run(function(){t.set("value",2)}),x.default.assert("",2==e.get("value")),x.default.assert("",2==t.get("value")),x.default.run(function(){t.set("pausingProperty",!0)}),x.default.assert("",2==e.get("value")),x.default.assert("",2==t.get("value")),x.default.run(function(){e.set("value",3)}),x.default.assert("",3==e.get("value")),x.default.assert("Target shouldn't have updated from",2==t.get("value")),x.default.run(function(){t.set("value",4)}),x.default.assert("Source should update from the to though",4==e.get("value")),x.default.assert("",4==t.get("value")),x.default.run(function(){e.set("value",5)}),x.default.assert("",5==e.get("value")),x.default.assert("",4==t.get("value")),x.default.run(function(){t.set("pausingProperty",!1)}),x.default.assert("",5==e.get("value")),x.default.assert("Target should sync from the from on resume",5==t.get("value")),x.default.run(function(){e.set("value",6)}),x.default.assert("",6==e.get("value")),x.default.assert("",6==t.get("value"))}function v(){var e=x.default.Object.create({value:0}),t=x.default.Object.create({from:e,valueBinding:ConditionalBinding.from("from.value").pauseIfTrue("pausingProperty").onlyPause("from").onResumeSetBothTo("to"),pausingProperty:!1});x.default.run(function(){t.set("value",2)}),x.default.assert("",2==e.get("value")),x.default.assert("",2==t.get("value")),x.default.run(function(){t.set("pausingProperty",!0)}),x.default.assert("",2==e.get("value")),x.default.assert("",2==t.get("value")),x.default.run(function(){e.set("value",3)}),x.default.assert("",3==e.get("value")),x.default.assert("Target shouldn't have updated from",2==t.get("value")),x.default.run(function(){t.set("value",4)}),x.default.assert("Source should update from the to though",4==e.get("value")),x.default.assert("",4==t.get("value")),x.default.run(function(){e.set("value",5)}),x.default.assert("",5==e.get("value")),x.default.assert("",4==t.get("value")),x.default.run(function(){t.set("pausingProperty",!1)}),x.default.assert("Source should sync from the to on resume",4==e.get("value")),x.default.assert("Target should sync from the from on resume",4==t.get("value")),x.default.run(function(){e.set("value",6)}),x.default.assert("",6==e.get("value")),x.default.assert("",6==t.get("value"))}function y(){var e=x.default.Object.create({value:0}),t=x.default.Object.create({from:e,valueBinding:ConditionalBinding.from("from.value").pauseIfTrue("pausingProperty").onlyPause("to").onResumeSetBothTo("from"),pausingProperty:!1});x.default.run(function(){t.set("value",2)}),x.default.assert("",2==e.get("value")),x.default.assert("",2==t.get("value")),x.default.run(function(){t.set("pausingProperty",!0)}),x.default.assert("",2==e.get("value")),x.default.assert("",2==t.get("value")),x.default.run(function(){e.set("value",3)}),x.default.assert("",3==e.get("value")),x.default.assert("Target should update from from",3==t.get("value")),x.default.run(function(){t.set("value",4)}),x.default.assert("Source shouldn't have updated from the to though",3==e.get("value")),x.default.assert("",4==t.get("value")),x.default.run(function(){t.set("pausingProperty",!1)}),x.default.assert("",3==e.get("value")),x.default.assert("To should sync from the from on resume",3==t.get("value")),x.default.run(function(){e.set("value",6)}),x.default.assert("",6==e.get("value")),x.default.assert("",6==t.get("value"))}function b(){p(),m(),v(),y()}Object.defineProperty(t,"__esModule",{value:!0});var w=i(2),x=n(w),P=new RegExp("[.]","g"),D=x.default.CollectionView.extend({showAllContent:!1,currentContent:null,init:function(){this._super(),this.updateCurrentContent()},updateCurrentContent:function(){var e=this.get("showAllContent");if(x.default.isNone(e)||!e){var t=this.get("content"),i=this.get("currentContent");this.get("childViews").forEach(function(e,n){var a=t.objectAt(n)==i;e.set("isVisible",a)})}else this.get("childViews").forEach(function(e){e.set("isVisible",!0)})}.observes("currentContent","showAllContent","childViews.@each")}),N=x.default.View.extend({downArrowButton:!1,classNames:["drop-down-menu"],layoutName:"drop-down-menu",didInsertElement:function(){var e=this.$("ul").hide(),t=!1,i=this.$(".button");this.get("downArrowButton")&&i.button({text:!1,icons:{primary:"ui-icon-triangle-1-s"}}),i.click(function(){return t?e.menu("refresh"):(e.menu(),t=!0),e.show().position({my:"left top",at:"left bottom",of:this}),$(document).one("click",function(){x.default.run.next(function(){e.hide()})}),!1})}}),C=x.default.TextArea.extend({didInsertElement:function(){this._super(),this.$().textareaAutoExpand()}}),S=/[^\x09\x0A\x0D\x20-\xFF\x85\xA0-\uD7FF\uE000-\uFDCF\uFDE0-\uFFFD]/gm,M=/^(.+)(e[+-]*\d+)$/,E=/\d/g,W={innerXML:r,toSigFig:c,countSigFigs:g,outerXML:o,makeUUID:s,CurrentCollectionView:D,ExpandingTextArea:C,DropDownMenuView:N,sanitizeStringForXML:l,removeXMLInvalidCharacters:d,shuffleArray:u,recreateCanvasElement:f,escapeForEmberProperty:a,makeDataKeyFromText:h};!function(e,t){"use strict;";e.ConditionalBinding=function(){t.Binding.apply(this,arguments)},e.ConditionalBinding.prototype=new t.Binding,e.ConditionalBinding.constructor=ConditionalBinding,e.ConditionalBinding.from=t.Binding.from,e.ConditionalBinding.to=t.Binding.to,e.ConditionalBinding.prototype.copy=function(){var e=new ConditionalBinding(this._to,this._from);return this._oneWay&&(e._oneWay=!0),e._pauseIfTruePath=this._pauseIfTruePath,e._directionToPause=this._directionToPause,e._directionToSyncOnResume=this._directionToSyncOnResume,e},e.ConditionalBinding.prototype.currentlyPaused=function(e){return!t.isNone(this._pauseIfTruePath)&&e.get(this._pauseIfTruePath)},e.ConditionalBinding.prototype.currentlyPausedFrom=function(e){return("from"==this._directionToPause||"both"==this._directionToPause)&&this.currentlyPaused(e)},e.ConditionalBinding.prototype.currentlyPausedTo=function(e){return("to"==this._directionToPause||"both"==this._directionToPause)&&this.currentlyPaused(e)},e.ConditionalBinding.prototype.connect=function(e){var i=this._pauseIfTruePath;return t.isNone(i)||t.addObserver(e,i,this,this.pauseDidChange),t.Binding.prototype.connect.apply(this,arguments)},e.ConditionalBinding.prototype.disconnect=function(e){var i=this._pauseIfTruePath;return t.isNone(pauseIfTrue)||t.removeObserver(e,i,this,this.pauseDidChange),t.Binding.prototype.disconnect.apply(this,arguments)},e.ConditionalBinding.prototype.pauseDidChange=function(e){if(!this.currentlyPaused(e)){var i=this._directionToSyncOnResume;"latest"==i&&(i=this._latestSyncDirection),"from"==i?t.Binding.prototype.fromDidChange.apply(this,arguments):"to"==i&&t.Binding.prototype.toDidChange.apply(this,arguments)}},e.ConditionalBinding.prototype.fromDidChange=function(e){return this.currentlyPausedFrom(e)?void(this._latestSyncDirection="from"):t.Binding.prototype.fromDidChange.apply(this,arguments)},e.ConditionalBinding.prototype.toDidChange=function(e){this.currentlyPausedTo(e)?this._latestSyncDirection="to":t.Binding.prototype.toDidChange.apply(this,arguments)},e.ConditionalBinding.prototype.pauseIfTrue=function(e){return this._pauseIfTruePath=e,this._directionToPause="both",this._directionToSyncOnResume="latest",this},e.ConditionalBinding.prototype.onlyPause=function(e){return this._directionToPause=e,this},e.ConditionalBinding.prototype.onResumeSetBothTo=function(e){return this._directionToSyncOnResume=e,this}}(window,x.default),b(),function(e,t){"use strict;";var i=function(e,i){function n(e,t){console.log("SETUP ALIAS",e,t)}function a(e,t){console.log("DESTROY ALIAS",e,t)}var o=!1,r=void 0,s=void 0,l=void 0,d=new t.ComputedProperty(function(t,n){var a=this.get(i),d=this.get(e),u=d!==r;r=d,u&&(s=!1);var c=o&&!a;return o=a,c&&s&&this.set(e,l),arguments.length>1&&(s=!0,l=n,a||this.set(e,n)),a||(l=this.get(e)),l});return d.meta({pausibleAlias:!0,setupPausibleAlias:n,destroyPausibleAlias:a}),d.property(e,i),d};t.Mixin.create({_eachPausibleAlias:function(e){var t=this;this.constructor.eachComputedProperty(function(i,n){n.pausibleAlias&&e.call(t,i,n)})},init:function(){this._super(),this._eachPausibleAlias(function(e,t){t.setupPausibleAlias(this,e)})},destroy:function(){this._super(),this._eachPausibleAlias(function(e,t){t.destroyPausibleAlias(this,e)})}});e.pausibleAlias=i}(W,x.default),W.evalInScope=eat_evalInScope,window.ElicitationUtils=W,t.default=W},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.Ember},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=i(2),o=n(a);try{document.domain="nearzero.org"}catch(e){}void 0==window.console&&(window.console=Object()),void 0==window.console.log&&(window.console.log=function(e){try{console.log(e)}catch(e){}}),window.debug={},Date.now=Date.now||function(){return(new Date).valueOf()},function(){if(o.default.platform.defineProperty.isSimulated){var e=o.default.meta(o.default.Object.create()).constructor;e.prototype.toJSON=function(){}}}();var r=o.default.Application.extend({LOG_TRANSITIONS:!0,ready:function(){this.instantiateResultsViews(),this.instantiateInlineViews(),$("#page-load-throbber").remove(),$.Placeholder.init(),$("body").on("click",".markdown a",function(e){console.log("Opening markdown link in new window"),e.preventDefault(),e.stopPropagation(),window.open($(this).attr("href"))})},instantiateResultsViews:function(){$("script[type='text/x-elicitation-widget-results-data']").each(function(){var e=$(this).html();try{var t=JSON.parse(e),i=o.default.String.classify(t.widgetType);console.log("Widget type is: "+i);var n=s.WidgetResultsViews[i];if(o.default.isNone(n))console.log("ERROR: couldn't find a ResultsView to display chart results of "+i+" widget");else{var a=s.WidgetResultsData.create({json:t,rawJSON:e}),r=n.create({content:a}),l=$(this).closest(".chart-holder");r.appendTo(l)}}catch(t){console.log("Error parsing JSON: "+t.toString()),debug.resultsDataString=e}})},instantiateInlineViews:function(){}}),s=o.default.Object.extend({createApp:function(e,t){var i=r.create({rootElement:e});return i.deferReadiness(),i.Router.map(function(){this.route("edit",{path:"/edit/:widget_id"})}),i.EditRoute=o.default.Route.extend({setupController:function(e){console.log("Setting up edit route controller!")}}),i.applicationView=o.default.View.extend({classNames:["elicitation-application"]}),i.IndexController=o.default.Controller.extend({elicitationBinding:"content",content:null}),i.IndexRoute=o.default.Route.extend({setupController:function(e){var i=s.Elicitation.create(t);e.set("content",i)}}),i.IndexView=o.default.View.extend({templateName:"elicitation",editModeBinding:"controller.elicitation.editMode"}),i}}).create();t.default=s},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=i(3),o=n(a),r=i(5),s=i(6),l=i(7),d=i(8),u=i(12),c=i(13);i(14);var g=i(15),f=i(11),h=i(17),p=i(18),m=n(p),v=i(19),y=i(21),b=i(20),w=i(22),x=i(23),P=i(24),D=n(P);o.default.RateLimitedViewMixin=r.RateLimitedViewMixin,o.default.MarkdownLabel=s.MarkdownLabel,o.default.CreateMarkdownConverter=s.CreateMarkdownConverter,o.default.VanillaMarkdownLabel=s.VanillaMarkdownLabel,o.default.PhraseDefinition=l.PhraseDefinition,o.default.PhraseDefinitionView=l.PhraseDefinitionView,o.default.PhraseDefinitionsView=l.PhraseDefinitionsView,o.default.PhraseDefinitionsController=l.PhraseDefinitionsController,o.default.Page=d.Page,o.default.PageView=d.PageView,o.default.PagesView=u.PagesView,o.default.PagesController=u.PagesController,o.default.WidgetGalleryView=c.WidgetGalleryView,o.default.WidgetResultsView=g.WidgetResultsView,o.default.WidgetResutlsData=g.WidgetResultsData,o.default.SerializedData=f.SerializedData,o.default.RootSerializedData=f.RootSerializedData,o.default.CloseEmbeddedView=h.CloseEmbeddedView,o.default.PostSubmitView=h.PostSubmitView,o.default.EditControlsView=h.EditControlsView,o.default.EditSidebarView=h.EditSidebarView,o.default.CustomWidgetsView=h.CustomWidgetsView,o.default.PageFooterView=h.PageFooterView,o.default.EditableWidgetView=h.EditableWidgetView,o.default.WidgetViewWrapper=h.WidgetViewWrapper,o.default.Elicitation=m.default,o.default.Schema=v.Schema,o.default.SchemaProperty=v.SchemaProperty,o.default.PropertyEditorView=y.PropertyEditorView,o.default.PropertyEditors=y.PropertyEditors,o.default.WidgetDefinition=b.WidgetDefinition,o.default.WidgetDefinitionEditorView=b.WidgetDefinitionEditorView,o.default.WidgetDefinitionEditorCategoryView=b.WidgetDefinitionEditorCategoryView,o.default.WidgetQualification=w.WidgetQualification,o.default.QualificationEditorView=w.QualificationEditorView,o.default.qualifications=w.qualifications,o.default.WidgetData=x.WidgetData,o.default.WidgetDataExplorer=x.WidgetDataExplorer,o.default.Widget=D.default},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(){var e=-1;if("Microsoft Internet Explorer"==navigator.appName){var t=navigator.userAgent,i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=i.exec(t)&&(e=parseFloat(RegExp.$1))}return e}function o(){if(d)return console.log("WARNING DEBUG CODE IS ON: DEBUG_MASQUERADE_AS_IE8=true in rate-limited-view.js, forcibly enabling rate limited views!"),!0;var e=a();return 8==e||7==e}function r(){console.log("showChunkOfViews, n=",g.length);for(var e=Date.now()+u;g.length>0&&Date.now()<e;){var t=g.pop();l.default.run(function(){t.showRateLimitedView()})}console.log("\tdone: ",e-Date.now(),"ms remain"),g.length>0&&(console.log("\ttime's up! rescheduling"),l.default.run.scheduleOnce("render",c,r)),console.log("\ttoShowQueue.length=",g.length)}Object.defineProperty(t,"__esModule",{value:!0}),t.RateLimitedViewMixin=void 0;var s=i(2),l=n(s),d=!1,u=5e3,c=null,g=[],f=l.default.Handlebars.compile(""),h=l.default.Mixin.create({_shouldBeVisible:!1,init:function(){this._super(),g.push(this),l.default.run.scheduleOnce("render",c,r)},template:function(){return console.log("template:"),this.get("_shouldBeVisible")?(console.log("\tReturning the real template!"),this._super()):(console.log("\tBlank template"),f)}.property("_shouldBeVisible"),render:function(e){console.log("Render called..."),this._super(e)},showRateLimitedView:function(){console.log("showRateLimitedView()"),this.set("_shouldBeVisible",!0)},fetchMe:function(){if(console.log("RateLimitedView.fetchMe()"),this.get("_shouldBeVisible"))return console.log("\tok: should be visible"),"*";throw"Fetch me should not be accessed until it _shouldBeVisible!"}.property()});o()?console.log("Loading rate-limited-view.js"):(console.log("Not on IE7/8, just using straight-up Ember.View"),t.RateLimitedViewMixin=h=l.default.Mixin.create({})),t.RateLimitedViewMixin=h},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=new Markdown.getSanitizingConverter,i=new RegExp("[']","g");return t.hooks.chain("postConversion",function(n){var a=e.get("phraseDefinitions"),n=n.replace(/\[\[([^\[\]]*)\]\]/gi,function(e,t){return a.getDefinitionOrCreate(t),"<span class='defined-term'><span class='phrase'>"+t+"</span></span>"}),o=s.default.A(),n=n.replace(/\{\{([^\{\}]*)\}\}/gi,function(e,t){return t=t.replace(i,""),o.push(t),"<span class='substituted-variable' variable='"+t+"'></span>"});return t.variableSubstitutions=o,"<div class='markdown'>"+n+"</div>"}),t}function o(){var e=new Markdown.getSanitizingConverter;return e.hooks.chain("postConversion",function(e){return"<div class='markdown'>"+e+"</div>"}),e}Object.defineProperty(t,"__esModule",{value:!0}),t.VanillaMarkdownLabel=t.CreateMarkdownConverter=t.MarkdownLabel=void 0;var r=i(2),s=n(r),l=i(1),d=n(l),u=s.default.View.extend({content:null,elicitation:void 0,classNames:["markdown-label"],init:function(){this._super(),s.default.assert("MarkdownLabel.elicitation must be set to an elicitation",!s.default.isNone(this.get("elicitation")))},template:s.default.Handlebars.compile("{{view.html}}"),variableSubstitutions:[],setupVariableSubstitutionObservers:function(){var e=this;e.get("elicitation.variableScope");var t=this.get("variableSubstitutions");t&&e.addObserver("elicitation.variableScope",function(){s.default.run.once(function(){var i=e.get("elicitation.variableScope");t.forEach(function(t){var n=void 0;try{n=d.default.evalInScope(t,i)}catch(e){}var a=e.$(".substituted-variable").filter("[variable='"+t+"']");n="number"==typeof n&&n!==parseInt(n,10)?n.toPrecision(3):String(n),a.html(n)})})})}.observes("variableSubstitutions.@each"),html:function(){var e=this.get("content");if(s.default.isNone(e))return"";var t=this.get("elicitation.markdownConverter");t.variableSubstitutions=void 0;var i=t.makeHtml(e).htmlSafe();return this.set("variableSubstitutions",t.variableSubstitutions),i}.property("content","elicitation.phraseDefinitions.@each"),didInsertElement:function(){var e=this.get("elicitation");e.get("phraseDefinitions");this.$().on("mouseenter",".defined-term",function(t){var i=$(this),n=e.get("editMode"),a=i.text(),o=e.get("phraseDefinitions").getDefinitionOrCreate(a);if(!o.get("isDefined")&&!n)return void console.log("Phrase ",a," is not yet defined");i.addClass("popped-out");var r=$("<div class='popup'/>"),s=e.get("markdownConverter").makeHtml(o.get("definition"));if(r.html(s),n){var l=$("<input type='submit' value='Edit Definition'/>");l.click(function(e){o.scrollToDefinition()});var d=$("<div class='edit-bar'></div>");d.append(l),r.append(d)}i.append(r)}).on("mouseleave",".defined-term",function(e){var t=$(this);t.find(".popup").remove(),t.removeClass("popped-out")}).on("click","img",function(e){var t=$(this),i=t.attr("src");window.open(i)})}}),c=s.default.View.extend({content:null,classNames:["markdown-label"],template:s.default.Handlebars.compile("{{view.html}}"),html:function(){var e=this.get("content");if(s.default.isNone(e))return"";var t=o(),i=t.makeHtml(e).htmlSafe();return i}.property("content"),didInsertElement:function(){this.$().on("click","img",function(e){var t=$(this),i=t.attr("src");window.open(i)})}});t.MarkdownLabel=u,t.CreateMarkdownConverter=a,t.VanillaMarkdownLabel=c,t.default=u},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.PhraseDefinitionsController=t.PhraseDefinitionsView=t.PhraseDefinitionView=t.PhraseDefinition=void 0;var a=i(2),o=n(a),r=i(1),s=(n(r),o.default.Object.extend(o.default.Evented,{phrase:"",definition:"",isDefined:function(){var e=this.get("definition");return void 0!=e&&e.length>0}.property("definition"),serializeDefinition:function(e){var t=$(e.createElement("definition"));return t.attr("phrase",this.get("phrase")),t.text(this.get("definition")),t},scrollToDefinition:function(){this.trigger("scrollToDefinition")}})),l=o.default.View.extend({init:function(){this._super(),this.get("content").on("scrollToDefinition",this,"scrollToDefinition")},scrollToDefinition:function(){var e=this.get("phrases");e.set("showBody",!0);var t=this.$();setTimeout(function(){e.$(".box-body").scrollTo(t,function(){t.find("textarea").focus().select()})},500)}}),d=o.default.View.extend({classNames:["phrase-definitions-view"],templateName:"phrase-definitions-view",showBody:!1,togglePopout:function(){this.set("showBody",!this.get("showBody"))}}),u=o.default.ArrayController.extend({definePhrase:function(e,t){var i=this.getDefinitionOrCreate(e);return i.set("definition",t),i},getDefinition:function(e){var t=this.find(function(t){return t.phrase===e});return t},getDefinitionOrCreate:function(e){var t=this.getDefinition(e);if(o.default.isNone(t)){var t=s.create({phrase:e});this.pushObject(t)}return t},content:[],unknownProperty:function(e){return this.getDefinition(e)},isNamespace:!1,serializeDefinition:function(e){return this.filterProperty("isDefined").map(function(t){return t.serializeDefinition(e)})},loadPhrasesFromXML:function(e){var t=this;e.each(function(){t.definePhrase($(this).attr("phrase"),$(this).text())})}});t.PhraseDefinition=s,t.PhraseDefinitionView=l,t.PhraseDefinitionsView=d,t.PhraseDefinitionsController=u,t.default=s},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.PageView=t.Page=void 0;var a=i(2),o=n(a),r=i(1),s=(n(r),i(9)),l=n(s),d=i(10),u=i(11),c=n(u),g=o.default.Object.extend({pagesController:void 0,elicitationBinding:"pagesController.elicitation",widgets:null,authorNotes:"",init:function(){this._super();var e=o.default.A(this.get("widgets"));this.set("widgets",e);var t=this,i=this.get("serializedDefinition");i&&i.children().each(function(){var i=this.nodeName.toLowerCase();if(i in d.WidgetRegistry){var n=d.WidgetRegistry[i];e.pushObject(n.create({serializedDefinition:$(this),elicitation:t.get("elicitation")}))}else"author-notes"==i?t.set("authorNotes",$(this).text()):console.log("Cannot de-serialize unknown widget named: "+i)})},createNewWidget:function(e){if(!o.default.isNone(e)){var t=d.WidgetRegistry[e],i=t.create({elicitation:this.get("elicitation")});this.get("widgets").pushObject(i),this.set("elicitation.widgetBeingEdited",i)}},redraw:function(){this.get("widgets").forEach(function(e){e.redraw()})},fixmeAvoidEachBugNumWidgets:function(){return this.get("widgets.length")}.property("widgets.length"),title:"Click Here to Edit the Page Title",pageNum:function(e,t){var i=this.get("pagesController"),n=i.indexOf(this);if(1===arguments.length)return n+1;var a=t-1;return a!=n&&(i.removeAt(n),i.insertAt(a,this)),t}.property("pagesController.@each"),firstPageAfterResume:function(){return this.get("pageNum")==this.get("elicitation.resumedStartingOnPageNum")}.property("pageNum","elicitation.resumedStartingOnPageNum"),isFirstPage:function(){return 1==this.get("pageNum")}.property("pageNum"),isLastPage:function(){return this.get("pagesController.numPages")==this.get("pageNum")}.property("pageNum","pagesController.numPages"),isCurrentPage:function(){var e=this.get("pagesController.currentPage");return e===this}.property("pagesController.currentPage"),serializeDefinition:function(e){var t=$(e.createElement("page"));t.attr("title",this.get("title")),this.get("widgets").forEach(function(i){t.append(i.serializeDefinition(e))});var i=this.get("authorNotes");if(!o.default.isNone(i)){var n=$(e.createElement("author-notes"));n.text(i),t.append(n)}return t},dataKeyBinding:"title",serializedData:function(){var e=c.default.create(),t=[],i=(this.get("title"),!1),n=this.get("elicitation.allowEditing");return this.get("widgets").forEach(function(a){var o=a.get("serializedData");if(o){i=!0,jQuery.extend(t,o.get("errors"));var r=a.get("dataKey");n&&!r&&alert("WARNING: widget without a valid dataKey, probably no title defined,data may be lost"),e[r]={data:o.get("data"),dataKeyText:a.get("dataKeyText")}}}),e.metadata={secondsExpertOnPage:this.get("secondsExpertOnPage")},l.default.create({data:e,errors:t})}.property().volatile(),expertOnPage:!1,beforeEnteringPage:function(){var e=this;this.get("widgets").forEach(function(t){t.beforeEnteringPage(e)})},beforeExitingPage:function(){var e=this;this.get("widgets").forEach(function(t){t.beforeExitingPage(e)})},_msExpertOnPage:0,timeExpertEnteredPage:null,accumulateTimeOnPage:function(){var e=this.get("timeExpertEnteredPage");if(!o.default.isNone(e)){var t=Date.now(),i=t-e;this.set("_msExpertOnPage",this.get("_msExpertOnPage")+i),this.set("timeExpertEnteredPage",t)}},startOrStopTiming:function(){var e=this.get("expertOnPage");e?this.set("timeExpertEnteredPage",Date.now()):(this.accumulateTimeOnPage(),this.set("timeExpertEnteredPage",null))}.observes("expertOnPage"),secondsExpertOnPage:function(){return this.accumulateTimeOnPage(),this.get("_msExpertOnPage")/1e3}.property("_msExpertOnPage").volatile()}),f=o.default.View.extend({page:void 0,elicitationBinding:"page.elicitation",classNames:["add-widget-to-page"],change:function(e){var t=this.get("page"),i=this.get("elicitation"),n=this.$("select"),a=n.val();if("prompt-no-action-required"!==a){if("show-gallery"===a)i.set("widgetGalleryIsOpen",!0),i.set("widgetGalleryAddsToPage",t);else{var o=a;t.createNewWidget(o)}n.val("prompt-no-action-required")}},widgetNames:function(){var e=o.default.A();for(var t in d.WidgetRegistry)e.pushObject(o.default.Object.create({widgetName:t,prettyName:d.WidgetRegistry[t].prettyName}));return e=e.sort(function(e,t){return e.get("prettyName")<=t.get("prettyName")?-1:1})}.property()}),h=o.default.View.extend({isVisible:!1,templateName:null,setTemplateOnceVisible:function(){this.get("isVisible")&&o.default.isNone(this.get("templateName"))&&(this.set("templateName","page"),this.rerender())}.observes("isVisible"),pageBinding:"content",pagesControllerBinding:"content.pagesController",classNames:["page-view"],nextButtonDisabled:!1,pageDOM:function(){return this.$().closest(".page")}.property(),nextButtonLabel:function(){var e=this.get("page");return o.default.isNone(e)?"Next":e.get("isLastPage")?"Submit Elicitation":"Next Â»"}.property("page.pageNum"),actions:{gotoNextPage:function(e){this.get("pagesController").gotoNextPage()},gotoPrevPage:function(e){this.get("pagesController").gotoPrevPage()},restartElicitationWithoutPriorData:function(e){function t(e,t){e=encodeURI(e),t=encodeURI(t);for(var i,n=document.location.search.substr(1).split("&"),a=n.length;a--;)if(i=n[a].split("="),i[0]==e){i[1]=t,n[a]=i.join("=");break}a<0&&(n[n.length]=[e,t].join("=")),document.location.search=n.join("&")}confirm("Are you sure you want to start over from scratch?\n\nPLEASE NOTE: clicking ok will ABANDON ANY PREVIOUS RESPONSES and you'll have to reenter them.")&&t("resumePriorSessionData","false")},removePage:function(){confirm("Delete the entire page? This will delete all the widgets on the page too.")&&this.get("pagesController").removeObject(this.get("page"))},movePageUp:function(){var e=this.get("pagesController"),t=this.get("page"),i=e.indexOf(t),n=0==i;n||(e.removeAt(i),e.insertAt(i-1,t))},movePageDown:function(){var e=this.get("pagesController"),t=this.get("page"),i=e.indexOf(t),n=i==e.get("length")-1;n||(e.removeAt(i),e.insertAt(i+1,t))},insertNewPageAfter:function(){var e=this.get("pagesController"),t=this.get("page"),i=e.indexOf(t);e.addNewPage(i+1)}},addWidgetToPageView:f});t.Page=g,t.PageView=h,t.default=g},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=i(2),o=n(a),r=o.default.Object.extend({init:function(){this.set("errors",o.default.A(this.get("errors")))},dataKey:null,dataKeyText:null,errors:null,data:null});t.default=r},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.WidgetRegistry=void 0;var a=i(2),o=(n(a),{});t.WidgetRegistry=o,t.default=o},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.RootSerializedData=t.SerializedData=void 0;var a=i(2),o=n(a),r=i(1),s=(n(r),o.default.Object.extend()),l=s.extend({getDataForWidget:function(e){var t=e.get("dataKey");return this.getDataForWidgetID(t)},getDataForWidgetID:function(e){for(var t in this)if(this.hasOwnProperty(t)){var i=this[t];if(o.default.isNone(i))continue;var n=i[e];if(!o.default.isNone(n))return n.data}}});t.SerializedData=s,t.RootSerializedData=l,t.default=s},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.PagesController=t.PagesView=void 0;var a=i(2),o=n(a),r=i(1),s=n(r),l=i(8),d=s.default.CurrentCollectionView.extend({elicitationBinding:"controller.elicitation",classNames:["pages"],itemViewClass:l.PageView,contentBinding:"elicitation.pagesController",currentContentBinding:"elicitation.pagesController.currentPage",showAllContentBinding:"elicitation.showAllPages"}),u=o.default.ArrayController.extend({elicitation:void 0,content:[],pageHistory:void 0,init:function(){this._super(),this.set("pageHistory",o.default.A())},numPages:function(){return this.get("content").length}.property("@each"),currentPage:null,currentPageNum:function(e,t){if(arguments.length>1){var i=t-1,n=this.get("content")[i];o.default.isNone(n)||this.set("currentPage",n)}var a=this.get("currentPage");return this.indexOf(a)+1}.property("currentPage"),redrawWidgetsOnShowAllPagesChange:function(){if(this.get("elicitation.showAllPages")){var e=this;window.setTimeout(function(){e.forEach(function(e){e.redraw()})},50)}else this.redrawWidgetsOnPageChange()}.observes("elicitation.showAllPages"),informPageExpertIsLeaving:function(){var e=this.get("currentPage");o.default.isNone(e)||e.set("expertOnPage",!1)}.observesBefore("currentPage"),informPageExpertIsEntering:function(){var e=this.get("currentPage");o.default.isNone(e)||(this.get("elicitation.editMode")?e.set("expertOnPage",!1):e.set("expertOnPage",!0));
}.observes("currentPage","elicitation.editMode"),redrawWidgetsOnPageChange:function(){var e=this.get("currentPage"),t=this;window.setTimeout(function(){t.get("elicitation.showAllPages")||$(window).scrollTop(0),e.redraw()},50)}.observes("currentPage"),thePageBefore:function(e){var t=this.get("content"),i=t.indexOf(e)-1;return i<0?null:t[i]},thePageAfter:function(e){var t=this.get("content"),i=t.indexOf(e)+1;return i>=t.length?null:t[i]},gotoPage:function(e){console.log("gotoPage(), pageNum: ",e.get("pageNum")),this.set("currentPage",e),this.runBeforeEnteringOnCurrentPage()},gotoNextPage:function(){var e=this.get("elicitation"),t=this.get("currentPage");if(!o.default.isNone(t)){var i=t.get("serializedData");if(i){var n=i.get("errors");if(n.length>0&&!confirm("This page isn't fully filled out, continue anyway?\n"+n.join("\n")))return;e.set("serializedDataIsEmpty",!1);var a=t.get("dataKey");!a&&e.get("allowEditing")&&alert("WARNING: page without a valid dataKey, probably no title defined"),e.setSerializedDataForPage(a,i.get("data"))}var r=t.get("isLastPage");try{if(t.get("isLastPage"))t.set("nextButtonDisabled",!0);else{t.beforeExitingPage(),this.get("pageHistory").push(t);var s=t!==this.get("currentPage");s||this.gotoPage(this.thePageAfter(t))}}finally{e.updateSerializedDataMetadata(r),e.submitData(r)}}},runBeforeEnteringOnCurrentPage:function(){this.get("currentPage").beforeEnteringPage()},gotoPrevPage:function(){var e=this.get("pageHistory").pop();if(o.default.isNone(e)){console.warn("pages.gotoPrevPage(): page history stack is empty, going to previous page by number instead");var t=this.get("currentPage");if(o.default.isNone(t))return;e=this.thePageBefore(t)}this.gotoPage(e)},ensureCurrentPageIsValid:function(){this.get("content").contains(this.get("currentPage"))||this.set("currentPage",this.get("content").get("firstObject"))}.observes("content","currentPage"),allWidgets:function(){var e=[];return this.forEach(function(t){t.get("widgets").forEach(function(t){e.push(t)})}),e}.property("@each.fixmeAvoidEachBugNumWidgets"),loadPagesFromXML:function(e){var t=this;e.each(function(){t.pushObject(l.Page.create({serializedDefinition:$(this),title:$(this).attr("title"),pagesController:t}))}),o.default.isNone(this.get("currentPage"))&&this.set("currentPage",this.get("firstObject"))},addNewPage:function(e){var t=l.Page.create({pagesController:this});o.default.isNone(e)?this.addObject(t):this.insertAt(e,t)},pageRangeForSelect:function(){for(var e=[],t=this.get("numPages"),i=1;i<=t;i++)e.push(i);return e}.property("numPages"),renameDuplicatePageTitles:function(){var e=o.default.Set.create();e.add("metadata");this.forEach(function(t){var i=t.get("dataKey");if(e.contains(i)){var n=t.get("title"),a=n+" "+Math.floor(1e6*Math.random()).toString();t.set("title",a)}e.add(t.get("dataKey"))})}});t.PagesView=d,t.PagesController=u},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.WidgetGalleryView=void 0;var a=i(2),o=n(a),r=i(1),s=(n(r),i(10)),l=o.default.View.extend({addToPage:void 0,elicitationBinding:"controller.elicitation",templateName:"widget-gallery",classNames:["widget-gallery"],widgetClicked:function(e){this.set("elicitation.widgetGalleryIsOpen",!1);var t=e.widgetName;this.get("addToPage");this.get("addToPage").createNewWidget(t)},closeWidgetGallery:function(){this.set("elicitation.widgetGalleryIsOpen",!1)},widgets:function(){var e=this.get("elicitation.widgetGalleryThumbnailsURL"),t=o.default.A();for(var i in s.WidgetRegistry)t.pushObject(o.default.Object.extend({widgetName:i,prettyName:s.WidgetRegistry[i].prettyName,thumbnailURL:function(){return e+"/"+this.get("widgetName")+".png"}.property("widgetName")}).create());return t=t.sort(function(e,t){return e.get("prettyName")<=t.get("prettyName")?-1:1})}.property()});t.WidgetGalleryView=l},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=i(2),o=n(a),r=i(3),s=n(r),l=i(10),d=i(15),u=i(16),c=n(u);s.default.reopen({Widgets:l.WidgetRegistry,isMobileDevice:function(){return window.isMobileDevice}.property(),unsupportedBrowser:function(){return!!(BrowserDetection.msie&&BrowserDetection.version<8)||(/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent),!1)}.property(),unsupportedBrowserForEditing:function(){return!!(BrowserDetection.msie&&BrowserDetection.version<9)||!!/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)}.property(),definitionDOMElements:c.default,WidgetResultsViews:d.WidgetResultsViewRegistry}),c.default.addObject("elicitation-definition").addObject("elicitation").addObject("page").addObject("phraseDefinitions").addObject("definition"),s.default.Variable=o.default.Object.extend({key:void 0,value:void 0}),s.default.DataDidntValidate=o.default.Object.extend({init:function(){this._super(),this.set("errors",o.default.A(this.get("errors")))},errors:null}),window.EAT=s.default,t.default=s.default},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.WidgetResultsData=t.WidgetResultsView=t.WidgetResultsViewRegistry=void 0;var a=i(2),o=n(a),r=o.default.View.extend({perExpertDataBinding:"content.perExpertData",layoutName:"results-chart-layout"}),s=o.default.Object.extend({json:void 0,rawJSON:void 0,questionTextBinding:"json.questionText",perExpertDataBinding:"json.data"}),l=o.default.Object.create();t.WidgetResultsViewRegistry=l,t.WidgetResultsView=r,t.WidgetResultsData=s},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=i(2),o=n(a),r=o.default.Set.create();t.default=r},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.WidgetViewWrapper=t.EditableWidgetView=t.PageFooterView=t.CustomWidgetsView=t.EditSidebarView=t.EditControlsView=t.PostSubmitView=t.CloseEmbeddedView=void 0;var a=i(2),o=n(a),r=o.default.View.extend({content:null,elicitationBinding:"controller.elicitation",widgetBinding:"content",classNameBindings:[":editable-widget",":could-be-edited","beingEdited"],templateName:"editable-widget",pageBinding:"parentView.page",actions:{editWidget:function(){this.set("elicitation.widgetBeingEdited",this.get("widget"))},moveWidgetUp:function(){var e=this.get("page"),t=e.get("widgets"),i=this.get("widget"),n=t.indexOf(i),a=0==n;if(a){var o=this.get("elicitation.pagesController").thePageBefore(e);o&&(t.removeObject(i),o.get("widgets").pushObject(i))}else t.removeAt(n),t.insertAt(n-1,i);i.scrollTo()},moveWidgetDown:function(){var e=this.get("page"),t=e.get("widgets"),i=this.get("widget"),n=t.indexOf(i),a=n==t.length-1;if(a){var r=this.get("elicitation.pagesController").thePageAfter(e);o.default.isNone(r)||(t.removeObject(i),r.get("widgets").unshiftObject(i))}else t.removeAt(n),t.insertAt(n+1,i);i.scrollTo()},removeWidget:function(){if(confirm("Delete widget?")){var e=this.get("page"),t=e.get("widgets"),i=this.get("widget");t.removeObject(i),this.get("elicitation.widgetBeingEdited")===i&&(console.log("Unsetting the widgetBeingEdited as it is being deleted"),this.set("elicitation.widgetBeingEdited",null))}}},beingEdited:function(){return this.get("elicitation.widgetBeingEdited")===this.get("widget")}.property("elicitation.widgetBeingEdited"),scrollToMeIfImBeingEdited:function(){this.get("beingEdited")&&this.get("widget").scrollTo()}.observes("beingEdited")}),s=o.default.ContainerView.extend({currentView:null,contentBinding:"currentView",classNames:["widget-view-wrapper"],willDestroyElement:function(){var e=this.get("currentView");this.removeObject(e),this._super()}}),l=o.default.View.extend({templateName:"page-footer",classNames:["page-footer"]}),d=o.default.View.extend({templateName:"custom-widgets",classNames:["custom-widgets"],actions:{injectCSSAndJavascript:function(){console.log("Applying custom css and javascript"),this.get("content").injectCSSAndJavascript()}}}),u=o.default.View.extend({elicitation:o.default.computed.alias("controller.elicitation"),templateName:"edit-sidebar",classNames:["edit-sidebar","slim-scrollbars"],onInit:function(){this.set("elicitation.hasBeenEdited",!0)}.on("init"),actions:{closeWidgetEditor:function(){this.set("elicitation.widgetBeingEdited",null)}},scrollToTopWhenWidgetChanges:function(){this.$().scrollTop(0)}.observes("elicitation.widgetBeingEdited"),connectWidgetBeingEditedOutlet:function(){var e=this.get("elicitation.widgetBeingEdited");if(console.log("EAT.EditSidebarView, widgetBeingEdited is now: ",e),debug.widgetBeingEdited=e,o.default.isNone(e))this.disconnectOutlet("widgetBeingEdited");else{this.disconnectOutlet("widgetBeingEdited");var t=this;o.default.run.next(function(){t.connectOutlet("widgetBeingEdited",e.get("definitionEditorView"))})}}.observes("elicitation.widgetBeingEdited")}),c=o.default.View.extend({elicitationBinding:"controller.elicitation",classNames:["edit-controls"],templateName:"edit-controls",actions:{addNewPage:function(){this.get("elicitation.pagesController").addNewPage()},saveChanges:function(){this.get("elicitation").saveChanges()},returnToDiscussion:function(){confirm("Return to discussion? Make sure you've saved!")&&(window.location.href=this.get("elicitation.discussionURL"))},toggleEditMode:function(e){this.toggleProperty("elicitation.editMode")}},editedSinceSavingBinding:"elicitation.hasBeenEdited",toggleEditModeLabel:function(){return this.get("elicitation.editMode")?"Preview":this.get("editedSinceSaving")?"Done...":"Edit"}.property("elicitation.editMode","editedSinceSaving")}),g=o.default.View.extend({templateName:"post-submit",classNames:["post-submit"],actions:{gotoDiscussion:function(){window.location.href=this.get("elicitation.discussionURL")}}}),f=o.default.View.extend({actions:{closeEmbeddedViewConfirm:function(){confirm("Close this elicitation before submitting?\n\nYour responses will NOT be saved.")&&parent.hideElicitationPopup()},closeEmbeddedViewPostSubmit:function(){parent.hideElicitationPopupPostSubmit()}}});t.CloseEmbeddedView=f,t.PostSubmitView=g,t.EditControlsView=c,t.EditSidebarView=u,t.CustomWidgetsView=d,t.PageFooterView=l,t.EditableWidgetView=r,t.WidgetViewWrapper=s},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _ember=__webpack_require__(2),_ember2=_interopRequireDefault(_ember),_elicitationUtils=__webpack_require__(1),_elicitationUtils2=_interopRequireDefault(_elicitationUtils),_serializedData=__webpack_require__(11),_markdownLabel=__webpack_require__(6),_phraseDefinition=__webpack_require__(7),_pages=__webpack_require__(12),PageFooterController=_ember2.default.Object.extend({label:"",serializeDefinition:function(e){var t=$(e.createElement("page-footer"));return t.text(this.get("label")),t},loadFromXML:function(e){this.set("label",$(e).text())}}),CustomWidgetsController=_ember2.default.Object.extend({javascript:"",css:"",serializeDefinition:function(e){var t=e.createElement("custom-widget"),i=e.createElement("javascript"),n=e.createElement("css");return $(i).text(this.get("javascript")),$(n).text(this.get("css")),t.appendChild(i),t.appendChild(n),t},loadFromXML:function(e){var t="",i="";e.find("javascript").each(function(){t+=$(this).text()}),e.find("css").each(function(){i+=$(this).text()}),this.set("javascript",t),this.set("css",i),this.injectCSSAndJavascript()},injectCSSAndJavascript:function(){try{window.eval(this.get("javascript")),$("style#custom-widget").remove(),$("<style></style>").attr("id","custom-widget").text(this.get("css")).appendTo($("body"))}catch(e){console.log("Error loading custom widget javascript or CSS: ",e),alert("Error loading custom widget javascript / css, see console for details.")}}}),Elicitation=_ember2.default.Object.extend({elicitationDefinition:null,priorSessionData:null,priorDataRaw:null,resumedFromPriorSessionData:!1,resumedStartingOnPageNum:null,embedded:!1,allowEditing:!1,editorWithoutAssignment:!1,switchToEditModeAfterLoading:!1,switchToReviewModeAfterLoading:!1,email:null,notTheLatestRevision:null,elicitationDefinitionID:null,cannotReachServer:!1,saveDataURL:null,discussionURL:null,saveDefinitionURL:null,redirectAfterSubmitURL:null,imageURL:null,uploadImageURL:null,reviewAdminURL:null,assignedToAdminURL:null,dataAdminURL:null,changeHistoryAdminURL:null,completePageMessage:null,completePageIncludeLinkToDiscussion:null,personID:null,init:function(){this._super(),window.debug.elicitation=this;var e={},t=!1;try{e=JSON.parse(this.get("priorSessionData")),t=!0}catch(e){}this.set("pageFooter",PageFooterController.create()),this.set("customWidgets",CustomWidgetsController.create()),this.set("phraseDefinitions",_phraseDefinition.PhraseDefinitionsController.create()),this.set("pagesController",_pages.PagesController.create({elicitation:this})),this.set("serializedData",_serializedData.RootSerializedData.create(e)),this.set("markdownConverter",(0,_markdownLabel.CreateMarkdownConverter)(this)),this.loadFromXML(this.get("elicitationDefinition"));var i=_ember2.default.ArrayController.create();this.set("customScriptingVariables",i);try{var n=JSON.parse(this.get("priorDataRaw"));for(var a in n)n.hasOwnProperty(a)&&i.pushObject(_ember2.default.Object.create({name:a,value:n[a]}))}catch(e){console.error("Couldn't parse priorData: ",e)}t&&this.resumeFromPriorSessionData(),_ember2.default.run.next(this,function(){this.get("pagesController").runBeforeEnteringOnCurrentPage()});var o=this;this.get("switchToEditModeAfterLoading")?window.setTimeout(function(){o.set("editMode",!0)},500):this.get("switchToReviewModeAfterLoading")&&window.setTimeout(function(){o.set("reviewMode",!0)},500),$(window).bind("beforeunload",function(){return o.beforeUnload()}),confidentialityIndicator.initialize($("#confidentiality-indicator-box")),confidentialityIndicator.setPolicy({"Your Participation":"Public","Your Responses (not attributed)":"Panel Only","Your Responses (attributed)":"Confidential"})},resumeFromPriorSessionData:function(){var e;(e=this.get("serializedData.metadata.currentPageNum"))&&(console.log("elicitation.resumeFromPriorSessionData(): setting page num to ",e),this.set("pagesController.currentPageNum",e),this.set("resumedFromPriorSessionData",!0),this.set("resumedStartingOnPageNum",e))},loadFromXML:function(e){var t=$($.parseXML(e)),i=t.find("elicitation");this.get("customWidgets").loadFromXML(i.children("custom-widget")),this.get("pagesController").loadPagesFromXML(i.children("page")),this.get("phraseDefinitions").loadPhrasesFromXML(i.children("definition")),this.get("pageFooter").loadFromXML(i.children("page-footer"))},numPages:_ember2.default.computed.alias("pagesController.numPages"),currentPageBinding:"pagesController.currentPage",widgets:_ember2.default.computed.alias("pagesController.allWidgets"),editMode:!1,reviewMode:!1,widgetGalleryIsOpen:!1,widgetGalleryAddsToPage:null,hideScrollbarsWhenWidgetGalleryIsShown:function(){this.get("widgetGalleryIsOpen")?$("html").css("overflow-y","hidden"):$("html").css("overflow-y","auto")}.observes("widgetGalleryIsOpen"),hasBeenEdited:!1,saveInProgress:!1,saveMessage:null,widgetBeingEdited:null,markdownConverter:null,customScriptingVariables:void 0,closeWidgetBeingEditedOnEditModeChange:function(){this.set("widgetBeingEdited",null)}.observes("editMode"),beforeUnload:function(){var e=/Firefox[\/\s](\d+)/.test(navigator.userAgent);return this.get("allowEditing")&&!this.get("definitionIsSaved")?"You may have unsaved changes to the elicitation.":this.get("submitted")||this.get("serializedDataIsEmpty")||e?void 0:"You can resume where you left off by visiting this elicitation again at a later time. You won't be able to go backward from this point, but all your previous responses will be preserved if you resume later."},print:function(){window.print()},saveChangesAs:function(){var e=prompt("Title for new elicitation?");_ember2.default.isNone(e)||(e.length<4?alert("WARNING: The title for the new elicitation was too short, not saving, please try again."):this.saveChanges(e))},saveChanges:function(e){var t=void 0!=e;this.set("saveInProgress",!0),this.set("saveMessage",void 0);var i=this.get("saveDefinitionURL"),n=this.serializeDefinition()[0];if(_elicitationUtils2.default.removeXMLInvalidCharacters(n),n=_elicitationUtils2.default.outerXML(n),!this.get("notTheLatestRevision")||confirm("Warning: you are editing a revision, saving changes will replace the latest version.")){var a="";if(!_ember2.default.isNone(a)){var o={ElicitationDefinition:n,ChangeSummary:a,SaveAsNewElicitation:t,SaveAsNewElicitationName:e};this.set("definitionHasBeenEdited",!1);var r=this;jQuery.post(i,o,function(i,n,a){var o=new Date,s=o.getHours(),l=s>12?"p":"a";s=s>12?s-12:s;var d=o.getMinutes();d=d<10?" "+d.toString():d.toString();var u=s+":"+d+l,c="Last save: "+u;t&&(c="Saved a copy",alert("A new elicitation named '"+e+"' has been created. You can access it from the discussion.")),r.set("saveMessage",c),console.log("saveChanges(), server response:",i)}).fail(function(e,t,i){window.debug.JqXHR=e,window.debug.TextStatus=t,window.debug.ErrorThrown=i,r.set("definitionHasBeenEdited",!0),alert("Error saving elicitation, is your internet still connected? Please try to save again.\n\n\t"+e.responseText),r.set("saveMessage","Problem saving!"),console.error("elicitation.saveChanges(), window.debug.definition="),window.debug.definition=n,console.warn(window.debug.definition),console.error("Error was:",e.responseText)}).always(function(){r.set("saveInProgress",!1)})}}},definitionIsSaved:function(){return!(this.get("definitionHasBeenEdited")||this.get("saveInProgress"))}.property("definitionHasBeenEdited","saveInProgress"),definitionHasBeenEdited:!1,watchWhenDefinitionIsEdited:function(){this.set("definitionHasBeenEdited",!0)}.observes("widgetBeingEdited"),serializeDefinition:function(){this.get("pagesController").renameDuplicatePageTitles();var e=$.parseXML("<elicitation></elicitation>"),t=$(e).find("elicitation");return this.get("pagesController").forEach(function(i){t.append(i.serializeDefinition(e))}),t.append(this.get("phraseDefinitions").serializeDefinition(e)),t.append(this.get("pageFooter").serializeDefinition(e)),t.append(this.get("customWidgets").serializeDefinition(e)),t},variables:function(){var e=[],t=this.get("widgets");_ember2.default.isNone(t)||t.forEach(function(t){t.get("definition.variables").forEach(function(t){e.push(t)})});var i=this.get("customScriptingVariables");return i.forEach(function(t){e.push(t)}),e}.property("widgets.@each.definition.variables.@each","customScriptingVariables.@each"),variableScope:function(){var e={};return this.get("variables").forEach(function(t){try{e[t.get("name")]=t.get("value")}catch(e){console.error("\tvariableScope(): error getting a variable",t,e)}}),e}.property("variables","variables.@each","variables.@each.name","variables.@each.value"),submitted:!1,pendingSubmitDataRequest:null,submitData:function submitData(finalSubmission){var data=this.get("serializedData");window.debug.lastSubmitData=data,finalSubmission&&console.log("submitData(): ",data);var email=this.get("email"),dataToSubmit=[{name:"email",value:email},{name:"elicitation_definition_id",value:this.get("elicitationDefinitionID")}];finalSubmission&&(dataToSubmit.push({name:"completed",value:"1"}),$("input#next").val("Submitting...").attr("disabled","disabled"));var json=JSON.stringify(data);dataToSubmit.push({name:"json",value:json});var pendingSubmitDataRequest=this.get("pendingSubmitDataRequest");pendingSubmitDataRequest&&pendingSubmitDataRequest.abort();var url=this.get("saveDataURL");if(void 0==url&&(url="/"),finalSubmission&&console.log(json),window.debug.lastSubmitJSON=json,this.get("editorWithoutAssignment")){if(console.warn("submitData(): moderator/admin without assignment, not submitting. see window.debug.lastSubmitJSON"),!finalSubmission)return;alert("As an admin/moderator you can edit this elicitation.\n\nBut you haven't assigned it to yourself, so you can't submit data responses to the server (yet).\n\nIf you want to test data submission, first assign the elicitation to yourself, then try submitting again.")}var elicitation=this;pendingSubmitDataRequest=jQuery.post(url,dataToSubmit,function(data,textStatus,jqXHR){elicitation.set("pendingSubmitDataRequest",null),elicitation.set("errorSubmittingToServer",!1),finalSubmission&&(elicitation.set("submitted",!0),$("div#footer").fadeOut(),$(".elicitation").fadeOut("fast",function(){var onSubmit=$("div.post-submit").attr("onSubmit");null!=onSubmit&&onSubmit.length>0?eval(onSubmit):elicitation.get("redirectAfterSubmitURL")?window.location=elicitation.get("redirectAfterSubmitURL"):$("div.post-submit").fadeIn("fast")}))}).fail(function(e,t,i){window.debug.JqXHR=e,window.debug.TextStatus=t,window.debug.ErrorThrown=i,window.debug.ResponseText=e.responseText,console.warn("window.debug.lastSubmitData = ",window.debug.lastSubmitData),console.warn("window.debug.lastSubmitJSON = ",window.debug.lastSubmitJSON),console.error("submitData() failed, server responded with an error:\n\n",debug.ErrorThrown,"\n",debug.ResponseText,"\n"),elicitation.set("errorSubmittingToServer",!0),finalSubmission&&($("input#next").val("Try to Submit Again").attr("disabled",!1),alert("Uhoh! We couldn't connect to the server to save your response data. Try submitting again?\n\nIf that doesn't work, please follow the instructions at the bottom of the page to submit by email."),elicitation.set("showSerializedData","URL: "+url+"\nEmail: "+email+"\nDate: "+(new Date).toString()+"\nData:\n"+json))}),this.set("pendingSubmitDataRequest",pendingSubmitDataRequest)},stateSave:function(){var e={};return this.get("widgets").forEach(function(t){try{e[t.get("dataKey")]=t.stateSave()}catch(e){console.log("Error saving state of widget ",t.get("dataKey"),e)}}),{widgets:e}},stateResume:function(e){var t=this.get("widgets"),i=e.widgets;_ember2.default.keys(i).forEach(function(e){try{var n=t.findBy("dataKey",e);n.stateResume(i[e]),n.redraw()}catch(t){console.log("Error restoring state of widget ",e,t)}})},getSerializedData:function(){return JSON.parse(JSON.stringify(this.get("serializedData")))},getSerializedDataFor:function(e){for(var t=this.getSerializedData(),i=_ember2.default.keys(t),n=0;n<i.length;n++){var a=t[i[n]],o=a[e];if(o)return o.data}},ping:function(e){return console.log("Elicitation.ping: ",e),"ping: "+e},firstWidget:function(){return this.get("pagesController.firstObject.widgets.firstObject")}.property().volatile(),showAllPages:function(){return this.get("editMode")||this.get("reviewMode")}.property("editMode","reviewMode"),serializedDataIsEmpty:!0,pageFooter:null,customWidgets:null,serializedData:null,setSerializedDataForPage:function(e,t){var i=this.get("serializedData");i[e]=t,this.notifyPropertyChange("serializedData")},updateSerializedDataMetadata:function(e){this.get("serializedData").metadata={currentPageNum:this.get("pagesController.currentPageNum"),elicitationIsComplete:e,resumedFromPriorSessionData:this.get("resumedFromPriorSessionData")},this.notifyPropertyChange("serializedData")},phraseDefinitions:null,pagesController:null});exports.default=Elicitation},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.SchemaProperty=t.Schema=void 0;var a=i(2),o=n(a),r=i(1),s=(n(r),i(20)),l=i(21),d=o.default.ArrayController.extend({init:function(){this.set("content",o.default.A(this.get("content")))},propertiesBinding:"content",definitionModel:s.WidgetDefinition,createDefinition:function(e,t){var i=this.get("definitionModel").create({schema:this,parent:e}),n=i;return this.forEach(function(e){var a=e.accessor,r=void 0,s=e.get("name");if(o.default.isNone(a)&&console.log("WARNING: property '"+s+"' has no accessor defined in its definitionSchema"),t&&(r=a.loadFromDefinition(n,t)),o.default.isNone(r)&&(r=i.get(s),o.default.isNone(r)&&a.getDefault&&(r=a.getDefault())),!o.default.isNone(r)){var l=e.get("type");"Boolean"==l&&(r="true"==r)}i.set(s,r)}),i},addProperty:function(e,t){t.set("name",e),t.set("schema",this),this.pushObject(t)}});d.reopenClass({createFromHash:function(e){var t=d.create();for(var i in e)if("model"!=i){var n=u.create(e[i]);t.addProperty(i,n)}return e.model?t.set("definitionModel",e.model):t.set("definitionModel",s.WidgetDefinition),t}});var u=o.default.Object.extend({name:void 0,category:"",type:"String",emphasizeWhenEmpty:!1,editorView:function(){return l.PropertyEditors.get(this.get("type"))}.property(),prettyName:function(){var e=this.get("name");return e.charAt(0).toUpperCase()+e.slice(1)}.property("name"),prettyNamePlural:function(){return this.get("prettyName")+"s"}.property("prettyName"),hasMany:function(){return"HasMany"===this.get("type")}.property("type"),visible:!0});t.Schema=d,t.SchemaProperty=u,t.default=d},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.WidgetDefinitionEditorCategoryView=t.WidgetDefinitionEditorView=t.WidgetDefinition=void 0;var a=i(2),o=n(a),r=i(1),s=n(r),l=i(16),d=n(l),u=i(19),c=o.default.Object.extend({schema:null,label:"What is your question?",categories:function(){var e=this.get("propertiesAndValues"),t={},i=o.default.Set.create();return e.forEach(function(e){var n=e.get("property.category"),a=o.default.A(t[n]);a.pushObject(e),t[n]=a,i.push(n)}),i.toArray().sort().map(function(e){return{name:e,propertiesAndValues:t[e],defaultCategory:""===e}})}.property("schema","propertiesAndValues"),propertiesAndValues:function(){for(var e=this.get("schema.properties"),t=[],i=0;i<e.length;i++){var n=e[i];t.pushObject(o.default.Object.create({property:n,definition:this,valueBinding:"definition."+n.get("name")}))}return t}.property("schema"),serialize:function(e){for(var t=this.get("schema.properties").filter(function(e){return!(1==e.get("dontSerialize"))}),i=0;i<t.length;i++){var n=t[i],a=this.get(n.get("name"));n.get("accessor").serialize(e,a)}},dataKeyTextBinding:"label",dataKey:function(){var e=this.get("dataKeyText");return e||console.log("WARNING: this widget has no dataKey() attribute, nor a dataKeyText() attribute defined to make a dataKey from. Data loss will probably occur"),s.default.makeDataKeyFromText(e)}.property("dataKeyText")});c.reopenClass({HasManyArray:o.default.ArrayController.extend(),ChildNode:function(e){return d.default.addObject(e),e=e.toLowerCase(),{loadFromDefinition:function(t,i){return i.children(e).text()},serialize:function(t,i){var n=t[0].ownerDocument,a=$(n.createElement(e));a.text(i),t.append(a)}}},Attr:function(e){return e=e.toLowerCase(),{loadFromDefinition:function(t,i){return i.attr(e)},serialize:function(t,i){t.attr(e,i)}}},Contents:function(){return{loadFromDefinition:function(e,t){return t.text()},serialize:function(e,t){var i=e[0].ownerDocument;e.append(i.createTextNode(t))}}},HasMany:function(e,t,i){d.default.addObject(e),e=e.toLowerCase();var n=u.Schema.createFromHash(t);return o.default.isNone(i)&&(i=c.HasManyArray),{getDefault:function(){return i.create({content:[],schema:n})},loadFromDefinition:function(t,a){var o=[];return a.children(e).each(function(){var e=$(this),i=n.createDefinition(t,e);o.pushObject(i)}),i.create({content:o,schema:n})},serialize:function(t,i){var n=t[0].ownerDocument;i.forEach(function(i){var a=$(n.createElement(e));i.serialize(a),t.append(a)})}}}});var g=o.default.View.extend({contentBinding:"definition",definition:null,templateName:"widget-definition-editor"}),f=o.default.View.extend({expanded:!1,actions:{toggleExpanded:function(){this.set("expanded",!this.get("expanded"))}}});t.WidgetDefinition=c,t.WidgetDefinitionEditorView=g,t.WidgetDefinitionEditorCategoryView=f},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.PropertyEditors=t.PropertyEditorView=void 0;var a=i(2),o=n(a),r=i(1),s=(n(r),o.default.View.extend({content:null,value:void 0,property:void 0,parentDefinition:void 0,toggleHelpText:function(){var e=this.$().find(".help-text");e.is(":visible")?e.slideUp():e.slideDown()}})),l=s.extend({templateName:"property-editor-enum",classNames:["property-editor","property-editor-enum"]}),d=s.extend({templateName:"property-editor-image",classNameBindings:[":property-editor",":property-editor-image","uploadInProgress"],uploadInProgress:!1,message:void 0,clearFileInput:function(){this.$(":file")[0].value=""},actions:{fileChanged:function(){var e=this.$(":file")[0],t=e.files[0],i=(t.name,t.size,t.type,!1);t.size>2e6&&(alert("The maximuum file size we permit is 2MB.\n\nPlease resize the image '"+t.name+"'in an image editor such as Adobe Photoshop, and/or save it in JPEG format."),i=!0),["image/jpeg","image/png","image/gif"].contains(t.type)||(alert("We do not support images in '"+t.type+"' format.\n\nPlease convert the image to JPEG, PNG or GIF format using an image editor such as Adobe Photoshop."),i=!0),i?this.clearFileInput():this.uploadImage()}},uploadImage:function(){function e(e){e.lengthComputable&&t.$("progress").attr({value:e.loaded,max:e.total})}var t=this,i=this.get("controller.elicitation.uploadImageURL"),n=new FormData(this.$("form.image-upload")[0]);this.set("uploadInProgress",!0),this.set("message","Uploading image..."),$.ajax({url:i,type:"POST",dataType:"json",xhr:function(){var t=$.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",e,!1),t},data:n,cache:!1,contentType:!1,processData:!1}).done(function(e){o.default.isNone(e)?(alert("Upload failed, not sure why, are you connected to the internet?"),t.set("message","Upload failed")):e.success?(t.set("value",e.imageID),t.set("message","New image uploaded!")):(alert("Error uploading image:\n"+e.errorMessage),t.set("message","Upload failed: "+e.errorMessage))}).fail(function(e,i,n){console.log("Error was: ",n),alert("Upload failed, not sure why, are you connected to the internet?"),t.set("message","Upload failed"),window.debug.jqXHR=e}).always(function(){t.set("uploadInProgress",!1),t.clearFileInput()})}}),u=o.default.Object.create({String:s.extend({templateName:"property-editor-string",classNames:["property-editor","property-editor-string"]}),Boolean:s.extend({templateName:"property-editor-boolean",classNames:["property-editor","property-editor-boolean"]}),Formula:s.extend({elicitationBinding:"controller.elicitation",templateName:"property-editor-formula",classNames:["property-editor","property-editor-formula"],resultBinding:"parentDefinition.formulaResult",formulaElements:function(){console.log("Getting formula elements");var e=this.get("elicitation.variables").getEach("name");return e.push(">"),e.push("<"),e.push(">="),e.push("<="),e.push("=="),console.log("Returning",e),e}.property("elicitation.variables.@each.name"),appendDataKey:function(){var e=this.get("dataKeyToAppend");if(!o.default.isNone(e)){var t=this.get("value");t+=e,this.set("value",t),this.set("dataKeyToAppend",null)}}.observes("dataKeyToAppend")}),Text:s.extend({templateName:"property-editor-text",classNames:["property-editor","property-editor-text"]}),MillionsOfDollars:s.extend({templateName:"property-editor-millions-of-dollars",classNames:["property-editor","property-editor-millions-of-dollars"]}),Image:d,Enum:l,Color:s.extend({templateName:"property-editor-color",classNames:["property-editor","property-editor-color"],didInsertElement:function(){this._super(),console.log("Converting to miniColors"),this.$().find("input#color").miniColors({letterCase:"uppercase",change:function(e,t){console.log("Change happened",e)}})}}),HasMany:s.extend({templateName:"property-editor-hasmany",classNames:["property-editor","property-editor-hasmany"],childrenBinding:"value",moveChild:function(e,t){var i=this.get("children"),n=i.indexOf(e),a=n+t;a>=0&&a<i.get("length")&&(i.removeAt(n),i.insertAt(a,e));
},actions:{addChild:function(){var e=this.get("children"),t=e.get("schema"),i=t.createDefinition(this.get("parentDefinition"));e.pushObject(i)},removeChild:function(e){var t=this.get("children");t.removeObject(e)},moveChildUp:function(e){this.moveChild(e,-1)},moveChildDown:function(e){this.moveChild(e,1)}}})});t.PropertyEditorView=s,t.PropertyEditors=u},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.qualifications=t.QualificationEditorView=t.WidgetQualification=void 0;var a=i(2),o=n(a),r=i(1),s=(n(r),o.default.Object.extend({widget:void 0,content:void 0,propertyName:void 0,prettyName:void 0,xmlAttr:void 0,editorView:l,serializedDataBinding:"content",init:function(){this._super(),this.bind("enabledInDefinition","widget.definition."+this.get("propertyName")),this.bind("enabledInData","widget.data."+this.get("propertyName"))},enabledInDefinition:void 0,enabledInData:void 0,beenHighlightedByView:!1,showQualification:function(){return this.get("enabledInDefinition")}.property("enabledInDefinition","enabledInData"),disableTogglingForParticipant:function(){return this.get("enabledInDefinition")}.property("enabledInDefinition")})),l=o.default.View.extend({classNames:["qualification-editor"],content:void 0,didInsertElement:function(){!this.get("content.showQualification")||this.get("content.enabledInDefinition")||this.get("content.beenHighlightedByView")||this.highlight()},highlight:function(){this.set("content.beenHighlightedByView",!0);var e=this;window.setTimeout(function(){var t=e.$();$.scrollTo(t,300,{offset:{top:-500},axis:"y",onAfter:function(){window.BrowserDetection.msie&&window.BrowserDetection.version<9||t.animate({backgroundColor:"rgba(255,0,0,1.0)"}).animate({backgroundColor:"rgba(255,255,255,0.0)"})}})},50)}}),d=l.extend({templateName:"dropdown-qualification-editor-view",selections:[{value:0,label:"0 - None"},{value:1,label:"1"},{value:2,label:"2 - Medium"},{value:3,label:"3"},{value:4,label:"4 - High"}]}),u=l.extend({templateName:"text-comment-qualification-editor-view",classNames:["text-comment"]}),c=o.default.A([s.extend({propertyName:"qualifyExpertise",prettyName:"Your Expertise",xmlAttr:"qualify-expertise",serializedDataBinding:"content.value",editorView:d}),s.extend({propertyName:"qualifyConfidence",prettyName:"Your Confidence",xmlAttr:"qualify-confidence",serializedDataBinding:"content.value",editorView:d}),s.extend({propertyName:"qualifyTextComment",prettyName:"Text Comment",xmlAttr:"qualify-text-comment",editorView:u})]);t.WidgetQualification=s,t.QualificationEditorView=l,t.qualifications=c},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t,i){if("object"==("undefined"==typeof e?"undefined":r(e))){for(var n in e)if(e.hasOwnProperty(n)){var o=l.default.isNone(i)?n:i+"â"+n;a(e[n],t,o)}}else t.push(l.default.Object.create({key:i,value:e}))}function o(e){e=JSON.parse(JSON.stringify(e));var t=[];return a(e,t),t}Object.defineProperty(t,"__esModule",{value:!0}),t.WidgetDataExplorer=t.WidgetData=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=i(2),l=n(s),d=i(1),u=(n(d),l.default.Object.extend({widget:void 0,definition:void 0}));u.reopenClass({CreateTable:function(e){var t=$.extend({tableModel:l.default.Object,rowModel:l.default.Object,colModel:l.default.Object,cellModel:l.default.Object,dataModel:null,rowDefinitionsBinding:"dataModel.definition.rows",colDefinitionsBinding:"dataModel.definition.cols"},e);l.default.assert("Parameter dataModel must be specified",!l.default.isNone(t.dataModel));var i=t.tableModel.extend({dataModel:t.dataModel,colDefinitionsBinding:t.colDefinitionsBinding,rowDefinitionsBinding:t.rowDefinitionsBinding,cols:function(){var e=this;return l.default.A(this.get("colDefinitions")).map(function(i){return t.colModel.create({definition:i,cells:null,table:e})})}.property("colDefinitions.@each"),rows:function(){var e=this,i=this.get("cols");i.forEach(function(e){e.set("cells",l.default.A([]))});var n=l.default.A(this.get("rowDefinitions")).map(function(n){var a=t.rowModel.create({definition:n,table:e});return a.set("cells",i.map(function(i){var n=t.cellModel.create({row:a,col:i,table:e});return i.cells.pushObject(n),n})),a});return n}.property("cols.@each","rowDefinitions.@each")});return i.create()},tabularPropertyOld:function(e){var t=$.extend({rowModel:l.default.Object,cellModel:l.default.Object,selfKeyName:"dataModel"},e),i=t.rowPath,n=t.colPath,a=(t.selfKeyName,t.rowModel),o=(t.cellModel,t.tableModel,i+".@each"),r=n+".@each";return function(){var e=this.get(i),t=(this.get(n),e.map(function(e){a.create({rowDefinition:e})}));return t}.property(o,r)}});var c=l.default.View.extend({widget:void 0,widgetID:function(){return this.get("widget.dataKey")}.property("widget.dataKey"),data:void 0,errors:void 0,onInit:function(){this.set("data",l.default.A(this.get("data")))}.on("init"),actions:{storeData:function(){var e=this.get("widget"),t=e.get("serializedData");this.set("errors",t.get("errors"));var i=t.get("data"),n=o(i);return void this.set("data",n)}},templateName:"widget-data-explorer"});t.WidgetData=u,t.WidgetDataExplorer=c},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=void 0;var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=i(2),r=n(o),s=i(1),l=n(s),d=i(20),u=i(23),c=i(19),g=i(11),f=i(22),h=i(9),p=n(h),m=i(10),v=n(m),y=i(16),b=n(y),w=r.default.View.extend({stateGetPropertyNames:function(e,t){function i(e,t){var i=r.default.meta(e);return!!(i&&i.descs&&i.descs[t]&&i.descs[t].func)&&i.descs[t].func.length<2}function n(e,t,n,o,s){function l(e){var t=r.default.keys(e);return e&&e._stateSkipKeys&&(t=t.filter(function(t){return!e._stateSkipKeys.contains(t)})),t}function d(e,c,g){return c>t?[]:l(e).filter(function(e){return!("@"==e[0]||"Binding"==e.slice(-7)||o.has(e))}).map(function(t){var o=g+"."+t;if(s.has(o))return[];try{var l=r.default.get(e,t);return"string"==typeof l||"number"==typeof l||"boolean"==typeof l||null===l|(n&&void 0===l)?i(e,t)?[]:[o]:Array.isArray(l)||"object"===("undefined"==typeof l?"undefined":a(l))&&l instanceof r.default.Object?u.has(l)?[]:(u.add(l),d(l,c+1,o)):[]}catch(e){return console.log("Couldn't get "+o,e),[]}}).filter(function(e){return e&&e.length>0}).reduce(function(e,t){return e.concat(t)},[])}var u=new Set([e,e.get("definition"),e.get("data")]),c=d(e.get("definition"),0,"definition"),g=d(e.get("data"),0,"data");return c.concat(g)}e|=8,t|=!1;var o=new Set(this.statePathsToSkip()),s=new Set(this.stateKeyNamesToSkip());return n(this,e,t,s,o)},lastSerializedData:function(){return this.get("elicitation").getSerializedDataFor(this.get("dataKey"))}.property().volatile(),stateSave:function(){return{properties:this.getProperties(this.stateGetPropertyNames()),serializedData:this.get("lastSerializedData")}},resumeFromSerializedData:function(e){},stateResume:function(e){this.setProperties(e.properties),this.resumeFromSerializedData(e.serializedData),this.afterStateResume&&this.afterStateResume(),this.redraw()},stateKeyNamesToSkip:function(){return["schema","propertiesAndValues"]},statePathsToSkip:function(){return["definition.schema","definition.visibleWhens","definition.variables"]},classNameBindings:[":elicitation-widget-view","conditionallyHidden","hasQualificationsToShow"],serializedDefinition:null,definition:void 0,data:null,qualifications:function(){var e=this;return f.qualifications.map(function(t){return t.create({widget:e})})}.property("elicitation.qualifications"),qualificationsToShow:function(){return this.get("qualifications").filterProperty("showQualification",!0)}.property("qualifications.@each.showQualification"),hasQualificationsToShow:function(){return this.get("qualificationsToShow").length>0}.property("qualificationsToShow"),layoutName:"widget-layout",dataModel:u.WidgetData,fixmeWatchVariables:function(){this.get("elicitation").notifyPropertyChange("variables")}.observes("definition.variables.@each"),addExtraPropertiesToSchema:function(e){e.addProperty("visibleWhens",c.SchemaProperty.create({type:"HasMany",category:"Variables",prettyName:"Visible-When",accessor:d.WidgetDefinition.HasMany("visible-when",{model:d.WidgetDefinition.extend({condition:"SomeVariableName > 30.5",formulaResult:void 0}),condition:{accessor:d.WidgetDefinition.Attr("condition"),type:"Formula"}})})),e.addProperty("variables",c.SchemaProperty.create({type:"HasMany",category:"Variables",prettyName:"Variable",accessor:d.WidgetDefinition.HasMany("variable",{model:D.extend({widget:this}),name:{accessor:d.WidgetDefinition.Attr("name"),type:"String"},property:{accessor:d.WidgetDefinition.Contents(),type:"String"}})})),e.addProperty("id",c.SchemaProperty.create({type:"String",prettyName:"id",visible:!1,accessor:d.WidgetDefinition.Attr("id")})),e.addProperty("hideOptionalQualifications",c.SchemaProperty.create({type:"Boolean",category:"Default Qualifications",prettyName:"Hide Qualify Your Answer",accessor:d.WidgetDefinition.Attr("hideOptionalQualifications")})),e.addProperty("responseIsOptional",c.SchemaProperty.create({type:"Boolean",prettyName:"Response is Optional",accessor:d.WidgetDefinition.Attr("responseIsOptional")})),this.get("qualifications").forEach(function(t){e.addProperty(t.propertyName,c.SchemaProperty.create({type:"Boolean",category:"Default Qualifications",prettyName:t.prettyName,accessor:d.WidgetDefinition.Attr(t.xmlAttr)}))})},_widget_OnInit:function(){r.default.assert("widget.elicitation must be set to an elicitation",!r.default.isNone(this.get("elicitation"))),this.set("data",this.get("dataModel").create({widget:this,definitionBinding:"widget.definition"}));var e=this.get("definitionSchema");r.default.assert("Widget must have a definitionSchema set",!r.default.isNone(e));var t=c.Schema.createFromHash(e),i=t.get("definitionModel").extend(x,{});t.set("definitionModel",i),this.addExtraPropertiesToSchema(t);var n=t.createDefinition(this,this.get("serializedDefinition"));this.set("definition",n),this.initWidget()}.on("init"),initWidget:function(){},conditionallyHidden:function(){var e=this.get("elicitation"),t=this.get("definition.visibleWhens.content"),i=!0;return!r.default.isNone(t)&&t.length>0&&t.forEach(function(t){var n=e.get("variableScope");try{i=i&&l.default.evalInScope(t.condition,n),t.set("formulaResult",i)}catch(e){t.set("formulaResult",e.toString())}}),!i}.property("definition.visibleWhens.@each.condition","elicitation.variableScope"),scrollTo:function(){var e=this;window.setTimeout(function(){var t=e.$();$.scrollTo(t,300,{offset:{top:-60},axis:"y"})},50)},definitionSchema:null,description:function(){return this.getDefinitionTag()}.property(),definitionEditorViewClass:function(){return d.WidgetDefinitionEditorView}.property(),definitionEditorView:function(){return this.get("definitionEditorViewClass").create({definition:this.get("definition"),widget:this})}.property("definition","definitionEditorViewClass").volatile(),getDefinitionTag:function(){return this.get("definitionTag")},serializeDefinition:function(e){var t=this.getDefinitionTag(),i=$(e.createElement(t)),n=this.get("definition");return n.serialize(i),i},serializedMetadata:function(){var e=g.SerializedData.create();return this.get("qualificationsToShow").forEach(function(t){var i=t.get("propertyName"),n=t.get("serializedData");e.set(i,n)}),e}.property().volatile(),responseIsOptional:r.default.computed.alias("definition.responseIsOptional"),serializedData:function(){var e=g.SerializedData.create(),t=[];return r.default.isNone(this.serializeData)?null:(this.serializeData(e,t),e.set("metadata",this.get("serializedMetadata")),this.get("responseIsOptional")&&(t=[]),p.default.create({data:e,errors:t}))}.property().volatile(),dataKeyBinding:"definition.id",dataKeyTextBinding:"definition.dataKeyText",redraw:function(){},didInsertElement:function(){this.setupDOM()},setupDOM:function(){},focusSelector:null,beforeEnteringPage:function(e){},beforeExitingPage:function(e){}});w.reopenClass({register:function(e,t){t.definitionTag=e;var i=this.extend(t);return i.reopenClass({definitionTag:e,prettyName:t.prettyName,widgetResults:t.widgetResults}),b.default.addObject(e),v.default[e]=i,i}});var x=r.default.Mixin.create({_id:void 0,id:function(e,t){arguments.length>1&&this.set("_id",t);var i=this.get("_id");return r.default.isNone(i)&&(i=l.default.makeUUID(),this.set("_id",i)),i}.property("_id")}),P=new RegExp("â","g"),D=d.WidgetDefinition.extend({widget:void 0,elicitationBinding:"widget.elicitation",name:"SomeVariableName",property:void 0,value:function(){try{var e=this.get("elicitation.serializedData");if(r.default.isNone(e))throw"elicitation.serializedData was null";var t=this.get("widget"),i=this.get("elicitation.serializedData").getDataForWidget(t),n=this.get("property");return n=n.replace(P,"."),i?r.default.get(i,n):void 0}catch(e){return void console.log("Error getting widget value: ",e)}}.property("elicitation.serializedData","widget.dataKey","property"),watchValue:function(){this.get("value")}.observes("value")});t.Widget=w,t.default=w},function(e,t,i){"use strict";i(26),i(27),i(28),i(29),i(30),i(31),i(32),i(33),i(34),i(35),i(37),i(38),i(39),i(40),i(41),i(42),i(43)},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=i(2),o=(n(a),i(24)),r=n(o),s=i(20),l=0;r.default.register("agree-disagree",{agreeDisagreeNum:null,prettyName:"Agree/Disagree",initWidget:function(){this.set("agreeDisagreeNum",l++)},templateName:"agree-disagree",definitionSchema:{label:{accessor:s.WidgetDefinition.ChildNode("label"),type:"Text"}},serializeData:function(e,t){var i=this.$().find("input[type='radio']:checked").val();e.set("agreement",i),i||t.pushObject("You didn't indicate if you agree/disagreed with one of the statements")},resumeFromSerializedData:function(e){if(e&&e.agreement){var t=this.$().find("input[type='radio']").toArray().find(function(t){return $(t).val()===e.agreement});$(t).prop("checked",!0)}}})},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){return e.mapProperty(t).reduce(function(e,t){return e+t},0)}var o=i(2),r=n(o),s=i(1),l=n(s),d=i(24),u=i(20),c=i(23),g=i(15);g.WidgetResultsViewRegistry.AllocationTable=g.WidgetResultsView.extend({templateName:"allocation-table-results",classNames:["widget-results","allocation-table"],content:void 0,dataTableAndFriends:function(){var e=new google.visualization.DataTable;e.addColumn({type:"string"});var t=new r.default.Set,i={};return this.get("content.perExpertData").mapProperty("data").forEach(function(n){console.log("allocation-table-results-chart for data row:",n);var a=e.addRow();e.setCell(a,0,a.toString());for(var o in n)if("metadata"!=o&&n.hasOwnProperty(o))for(var r in n[o])if(n[o].hasOwnProperty(r)){console.log("a=",o,", b=",r);var s=n[o][r],l=o+", "+r,d=null;t.contains(l)?d=i[l]:(console.log("new name "+l+": adding"),t.add(l),d=e.addColumn({type:"number",label:l}),i[l]=d),e.setCell(a,d,s)}}),console.log("Returning allocation-table results data table"),{dataTable:e,seriesNameToColNum:i,seriesNames:t}}.property("content.perExpertData"),didInsertElement:function(){this._super();var e=this.$("div.google-chart-holder"),t=this;google.load("visualization","1",{packages:["corechart"],callback:function(){var i=new google.visualization.LineChart(e.get(0)),n={lineWidth:0,pointSize:5,backgroundColor:"#707580",titlePosition:"none",vAxis:{viewWindowMode:"pretty",textStyle:{color:"white"},gridlines:{color:"#888"},baselineColor:"#707580"},hAxis:{format:"#",viewWindowMode:"pretty",textStyle:{color:"white"},gridlines:{color:"#888"},baselineColor:"#707580"},theme:"maximized"},a=t.get("dataTableAndFriends");window.dataTableAndFriends=a;var o=["#19b5eb","rgb(217,76,116)","rgb(123,105,209)","rgb(235,136,35)","rgb(76,166,73)","rgb(64,133,198)","rgb(228,81,39)","rgb(90,86,196)","rgb(168,206,56)","rgb(255,205,5)","rgb(16,147,128)","rgb(154,61,168)"],r={};a.seriesNames.forEach(function(e){var t=o.shift(),i=a.seriesNameToColNum[e];r[i]={color:t}}),n.series=r,i.draw(a.dataTable,n),debug.googleChart=i,debug.googleChartDataTable=a.dataTable,t.set("googleAvailable",!0)}})}}),$.widget("nz.dragdistance",$.ui.mouse,{options:{drag:null,start:null,stop:null},_create:function(){this.element.disableSelection(),this._mouseInit()},_mouseStart:function(e){this.startEvent=e,this.options.start&&this.options.start()},_getDist:function(e){var t=e.screenX-this.startEvent.screenX,i=e.screenY-this.startEvent.screenY,n=Math.sqrt(t*t+i*i);return e.screenY<this.startEvent.screenY?n:-n},_mouseDrag:function(e){this.options.drag&&this.options.drag(this._getDist(e))},_mouseStop:function(e){this.options.stop&&this.options.stop(this._getDist(e)),this.startEvent=null}});var f=r.default.View.extend({templateName:"allocation-table-cell-graphic",content:null,classNameBindings:[":graphic-holder"],inserted:!1,didInsertElement:function(){this.set("inserted",!0);var e,t=this;this.$().dragdistance({drag:function(i){i/=2,t.set("content.allocated",e+i)},start:function(){e=t.get("content.allocated")},stop:function(t){e=null}})},holderElement:function(){if(this.get("inserted"))return this.$()}.property("inserted"),holderWidth:function(){var e=this.get("holderElement");return r.default.isNone(e)?void 0:e.width()}.property("holderElement"),makeHolderHeightMatchWidth:function(){var e=this.get("holderElement"),t=this.get("holderWidth");r.default.isNone(e)||r.default.isNone(t)||e.height(t)}.observes("holderWidth"),maxGraphicWidthBinding:"holderWidth",maxAllocatedBinding:"content.table.maxAllocated",graphicSizePx:function(){var e=this.get("maxGraphicWidth"),t=this.get("content.allocated"),i=this.get("maxAllocated"),n=t/i;return n*e}.property("maxGraphicWidth","maxAllocated","content.allocated"),graphicStyle:function(){var e=this.get("graphicSizePx"),t="width: "+e+"px;height: "+e+"px;";return t}.property("graphicSizePx")}),h=r.default.View.extend({templateName:"allocation-table-cell",content:null,tagName:"td",graphicalInputBinding:"content.table.dataModel.graphicalInput",classNameBindings:[":cell","content.allocatedStringIsInvalid","content.locked","graphicalInput"],toggleLocked:function(){this.toggleProperty("content.locked")},graphicView:f,allocatedTextField:r.default.TextField.extend({precision:null,valueBinding:"allocated",focused:!1,observeValueWhileFocused:function(){if(this.get("focused")){var e=this.get("value");this.set("allocated",e);var t=l.default.countSigFigs(e)+1,i=this.get("precision");i<t&&this.set("precision",t)}}.observes("value"),focusIn:function(e){this.set("focused",!0),this.get("valueBinding").disconnect(this)},focusOut:function(e){this.set("focused",!1);var t=this.get("value");this.get("valueBinding").connect(this),this.set("value",t)}})}),p=h.extend({tagName:"td",classNameBindings:[":summation"]}),m=r.default.Mixin.create({allocatedStringPrecision:void 0,allocatedStringIsInvalid:!1,allocatedString:function(e,t){if(this.set("allocatedStringIsInvalid",!1),arguments.length>1){var i=parseFloat(t);isNaN(i)?this.set("allocatedStringIsInvalid",!0):this.set("allocated",i)}var n=this.get("allocated"),a=this.get("allocatedStringPrecision");return l.default.toSigFig(n,a)}.property("allocated","numDigitsPrecision")}),v=r.default.Object.extend(m,{allocatedStringPrecisionBinding:"table.allocatedStringPrecision",_stateSkipKeys:["col","row","table","allocationStringPrecision"],col:null,row:null,table:null,allocated:0,locked:!1}),y=r.default.Mixin.create(m,{deepChildrenBinding:"children",unlockedChildren:function(){return this.get("deepChildren").rejectProperty("locked")}.property("deepChildren.@each.locked"),allocated:function(e,t){if(arguments.length>1&&0!=t){var i=a(this.get("deepChildren"),"allocated"),n=t-i,o=this.get("unlockedChildren"),r=a(o,"allocated");if(0!=r){var s=r+n,l=s/r;o.forEach(function(e){e.set("allocated",e.get("allocated")*l)})}else{var d=n/o.get("length");o.setEach("allocated",d)}}return a(this.get("children"),"allocated")}.property("children.@each.allocated"),locked:function(e,t){return arguments.length>1&&this.get("deepChildren").setEach("locked",t),this.get("deepChildren").everyProperty("locked")}.property("deepChildren.@each.locked")}),b=r.default.Object.extend(y,{_stateSkipKeys:["locked","allocated","label"],definition:null,labelBinding:"definition.label",childrenBinding:"cells",allocatedStringPrecisionBinding:"table.allocatedStringPrecision"}),w=r.default.Object.extend(y,{definition:null,labelBinding:"definition.label",childrenBinding:"cells",allocatedStringPrecisionBinding:"table.allocatedStringPrecision"}),x=r.default.Object.extend(y,{allocatedStringPrecisionBinding:"dataModel.allocatedStringPrecision",childrenBinding:"rows",deepChildrenBinding:"cells",cells:function(){var e=this.get("rows").mapProperty("cells").reduce(function(e,t){return e.concat(t)},[]);return e}.property("rows.@each.cells.@each"),maxAllocated:function(){var e=20;return this.get("cells").mapProperty("allocated").reduce(function(e,t){return null!=e&&e>t?e:t},e)}.property("cells.@each.allocated")}),P=c.WidgetData.extend(m,{allocatedStringPrecision:2,table:null,graphicalInput:!1,init:function(){this._super(),this.set("table",c.WidgetData.CreateTable({dataModel:this,rowDefinitionsBinding:"dataModel.definition.rows",colDefinitionsBinding:"dataModel.definition.cols",rowModel:b,colModel:w,cellModel:v,tableModel:x}))},totalAllocationBinding:"definition.totalAllocation",allocated:r.default.computed.alias("table.allocated"),fullyAllocated:function(){var e=this.get("toAllocate");return e<=1e-13&&e>=-1e-13}.property("toAllocate"),toAllocate:function(){return this.get("totalAllocation")-this.get("allocated")}.property("allocated","totalAllocation")});d.Widget.register("allocation-table",{prettyName:"Allocation Table",templateName:"allocation-table",widgetResults:g.WidgetResultsViewRegistry.AllocationTable,dataModel:P,definitionSchema:{model:u.WidgetDefinition.extend({totalAllocation:100}),label:{accessor:u.WidgetDefinition.ChildNode("label"),type:"Text"},totalAllocation:{accessor:u.WidgetDefinition.Attr("total-allocation"),prettyName:"Allocation",type:"String"},unitSuffix:{accessor:u.WidgetDefinition.Attr("unit-suffix"),prettyName:"Units",helpText:"Units for the value being allocated, e.g. the 'kg' in 50kg"},unitPrefix:{accessor:u.WidgetDefinition.Attr("unit-prefix"),prettyName:"Prefix for Units",helpText:"Prefix to the value being allocated, e.g. the '$' in $50m"},cols:{type:"HasMany",prettyName:"Col",emphasizeWhenEmpty:!0,accessor:u.WidgetDefinition.HasMany("column",{model:u.WidgetDefinition.extend({label:"untitled col"}),label:{accessor:u.WidgetDefinition.ChildNode("label")}})},rows:{type:"HasMany",prettyName:"Row",emphasizeWhenEmpty:!0,accessor:u.WidgetDefinition.HasMany("row",{model:u.WidgetDefinition.extend({label:"untitled row"}),label:{accessor:u.WidgetDefinition.ChildNode("label")}})}},initWidget:function(){this._super(),window.debugAllocationTable=this},setupDOM:function(){},serializeData:function(e,t){var i=this.get("data.table");if(i.get("rows").forEach(function(t){var i={};t.get("cells").forEach(function(e){var t=l.default.escapeForEmberProperty(e.get("col.definition.label"));i[t]=e.get("allocated")});var n=l.default.escapeForEmberProperty(t.get("definition.label"));e.set(n,i)}),!this.get("data.fullyAllocated")){var n=e.get("totalAllocation"),a=e.get("allocated");t.pushObject("You allocated "+a+", but the requested allocation was "+n)}},stateKeyNamesToSkip:function(){return this._super().concat(["allocatedStringIsInvalid","allocatedString","allocatedStringPrecision","__each","deepChildren"])},statePathsToSkip:function(){return this._super().concat(["data.table.cols","data.table.locked","data.table.allocated","data.totalAllocation","data.allocated"])},showRowSums:function(){return this.get("data.table.cols.length")>1}.property("data.table.cols.length"),showColSums:function(){return this.get("data.table.rows.length")>1}.property("data.table.rows.length"),cellView:h,summationCellView:p,actions:{scaleToTotal:function(){var e=this.get("data.totalAllocation");this.set("data.table.allocatedString",e)}}})},function(e,t){"use strict"},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){e.beginPath(),e.moveTo(0,0),e.lineTo(-12,-6),e.lineTo(-12,6),e.closePath(),e.fill()}function o(e){return Math.log(e)/Math.log(10)}function r(e,t,i,n){var a="rgb(150,150,255)",o=2,r=2,s=60,l=(e.height,e.width),d=e.getContext("2d");d.save(),d.translate(r,s),d.strokeStyle=a,d.lineCap="round";for(var u=[{percentile:0,x:i(t._0th)},{percentile:25,x:i(t._25th)},{percentile:50,x:i(t._50th)},{percentile:75,x:i(t._75th)},{percentile:100,x:i(t._100th)}],c=[],g=5,f=1;f<g;f++){var h=u[f],p=u[f-1],l=h.x-p.x,m=h.percentile-p.percentile;c.push({x1:p.x,x2:h.x,y:m/l})}var v=100;d.lineWidth=o,d.fillStyle="rgba(0,0,255,0.1)";for(var f=0;f<c.length;f++){var y=c[f];y.y*=v,d.beginPath(),d.moveTo(y.x1,0),d.lineTo(y.x1,y.y),d.lineTo(y.x2,y.y),d.lineTo(y.x2,0),d.stroke(),d.closePath(),d.fill()}d.restore()}function s(e,t,i,n){var r="rgb(60,60,60)",s=15,l=2,d=60,u=(e.height,e.width),c=e.getContext("2d");c.save(),c.translate(l,d),c.strokeStyle=r,c.lineCap="round",c.lineWidth=1,c.beginPath(),c.moveTo(0,0),c.lineTo(u,0),c.stroke(),c.fillStyle=r,c.save(),c.rotate(Math.PI),a(c),c.restore(),c.save(),c.translate(u,0),a(c),c.restore(),c.lineWidth=2,c.save(),c.translate(0,-s/2),c.textAlign="center",c.textBaseline="top",c.font="12pt Helvetica";var g=i-t,f=Math.round(o(g)),h=Math.pow(10,f),m=1,v=9,y=15;g/h<v&&(h/=10,f--),g/h<v&&(h/=2,f--),g/h>y&&(m*=2);var b=h*m,w=Math.round(t/b)*b;p&&console.log("Drawing axis: range is",g,"scale is",f,"tickSize is",h,"majorTickEvery is",m,"start is",w);for(var x=0,P=w;P<i;P+=h){var D=n(P),N=x>=m;if(N&&(x=0),x++,!(D<15||D>u-15)){c.save();var C=0;if(N?c.lineWidth=2:(C=1,c.lineWidth=1),c.translate(Math.round(D),Math.round(C)),c.beginPath(),c.moveTo(0,0),c.lineTo(0,Math.round(s-2*C)),c.stroke(),N){var S;S=f<1?P.toFixed(Math.abs(f)):P.toFixed(),c.fillText(S,0,s+5)}c.restore()}}c.restore(),c.restore()}var l=i(2),d=n(l),u=i(1),c=n(u),g=i(24),f=i(20),h=i(23),p=!1,m=7,v=["_0th","_25th","_50th","_75th","_100th"];g.Widget.register("box-and-whiskers",{prettyName:"Box n' Whiskers",value:null,shape:0,scale:1,location:0,doneWithWhiskers:!1,doneClicking:!1,templateName:"box-and-whiskers",dataModel:h.WidgetData.extend({_0th:void 0,_25th:void 0,_50th:void 0,_75th:void 0,_100th:void 0,percentilesAreDone:function(){return!d.default.isNone(this.get("_50th"))}.property("_50th")}),definitionSchema:{model:f.WidgetDefinition.extend({_min:.1,_max:4,min:function(e,t){return arguments.length>1?void this.set("_min",parseFloat(t)):this.get("_min")}.property("_min").volatile(),max:function(e,t){return arguments.length>1?void this.set("_max",parseFloat(t)):this.get("_max")}.property("_max").volatile(),axisLabel:"Axis Label (kg)",label_0th:"Minimum",label_25th:"25th Percentile",label_50th:"Median",label_75th:"75th Percentile",label_100th:"Maximum"}),label:{accessor:f.WidgetDefinition.ChildNode("label"),type:"Text"},min:{accessor:f.WidgetDefinition.Attr("min"),prettyName:"Starting Min",helpText:"The initial minimum value of the box-plot axis. Note that users can select smaller values by manually dragging the whiskers."},max:{accessor:f.WidgetDefinition.Attr("max"),prettyName:"Starting Max",helpText:"The initial maximum value of the box-plot axis. Note that users can select larger values by manually dragging the whiskers."},axisLabel:{accessor:f.WidgetDefinition.Attr("axis-label"),prettyName:"Axis Label"},label_0th:{accessor:f.WidgetDefinition.Attr("label-0th"),prettyName:"0th Percentile",category:"Percentile Labels"},label_25th:{accessor:f.WidgetDefinition.Attr("label-25th"),prettyName:"25th Percentile",category:"Percentile Labels"},label_50th:{accessor:f.WidgetDefinition.Attr("label-50th"),prettyName:"50th Percentile",category:"Percentile Labels"},label_75th:{accessor:f.WidgetDefinition.Attr("label-75th"),prettyName:"75th Percentile",category:"Percentile Labels"},label_100th:{accessor:f.WidgetDefinition.Attr("label-100th"),prettyName:"100th Percentile",category:"Percentile Labels"}},initWidget:function(){this._super(),p&&(this.get("data").setProperties({_0th:5,_25th:15,_50th:20,_75th:25,_100th:45}),this.setProperties({shape:3,scale:1.55,location:-1.7}))},afterStateResume:function(){var e=this.get("data").getProperties(v),t=v.every(function(t){return!d.default.isNone(e[t])});if(t)this.set("doneWithWhiskers",!0),this.set("doneClicking",!0);else{var i=this.get("data");v.forEach(function(e){i.set(e,void 0)})}},serializeData:function(e,t){var i=this.get("data").getProperties(v);this.get("data.percentilesAreDone")||t.pushObject("You haven't finished specifying the percentiles.");var n=this.get("currentQuestion");if(n.length>0){var a=n.attr("key");console.log("Setting ",a," from ",i[a]," to undefined"),i[a]=void 0}e.setProperties(i)},setCurrentQuestionToMouseX:function(e){var t=this.get("currentQuestion"),i=e.pageX-this.get("boxPlot").offset().left,n=this.get("pixelToModelCoords")(i),a=t.attr("key");p&&console.log("Setting",a,"to",n),this.get("data").set(a,n),this.enforceModelConstraints()},BoxPlotSubView:d.default.View.extend({boxAndWhiskers:void 0,classNames:["box-plot"],click:function(e){this.get("boxAndWhiskers").boxPlotClicked(e)}}),updateCurrentQuestionText:function(){var e=this.get("currentQuestion"),t="label"+e.attr("key");this.set("currentQuestionText",this.get("definition").get(t))},boxPlotClicked:function(e){this.setCurrentQuestionToMouseX(e);var t=this.get("currentQuestion");"_100th"==t.attr("key")&&this.set("doneWithWhiskers",!0),t.removeClass("current"),t.addClass("done"),t=t.nextAll("li").first(),0==t.length?this.set("doneClicking",!0):(t.addClass("current"),this.updateCurrentQuestionText()),this.redraw()},hideMouseCursorWhenDoneClicking:function(){this.$().find("#mouse-cursor").remove()}.observes("doneClicking"),currentQuestionText:"Minimum",redrawOnDefChange:function(){this.get("haveSetupDOM")&&this.redraw()}.observes("definition.min","definition.max","shape","scale","location"),redraw:function(){function e(e){return e/d*w+c}function t(e){return(e-c)/w*d}var i=this.get("boxPlot"),n=this.get("data"),a=this.get("definition"),o=i.find("canvas#axis"),l=o.get(0),d=l.width=i.width(),u=l.height=i.height();o.width(d).height(u);var c,g,f=n._0th&&n._100th,h=f&&n._25th&&n._75th,m=h&&n._50th,v=this.get("doneClicking"),y=this.get("doneWithWhiskers");if(y){p&&console.log("Draw whiskers");var b=n._100th-n._0th;c=n._0th-b/2,g=n._100th+b/2}else c=a.get("min"),g=a.get("max"),p&&console.log("Using min and max",c,g);var w=g-c;v&&r(l,n,t,e,this.get("shape"),this.get("scale"),this.get("location")),s(l,c,g,t),this.set("pixelToModelCoords",e),this.set("modelToPixelCoords",t);var x=i.find("#whiskers"),P=i.find("#box"),D=i.find("#median"),N=0;parseInt(x.css("border-right-width"));var C=0;parseInt(P.css("border-right-width"));var S=t(n._0th),M=t(n._100th)-S-N,E=t(n._25th),W=t(n._75th)-E-C,_=t(n._50th);f?x.css({left:S,width:M}).fadeIn():x.fadeOut(),h?P.css({left:E,width:W}).fadeIn():P.fadeOut(),m?D.css({left:_}).fadeIn():D.fadeOut()},onBoxResize:function(e,t){var i=this.get("box"),n=this.get("whiskers"),a=this.get("median"),o=t.position.left,r=t.size?t.size.width:i.width(),s=o+r,l=parseFloat(n.css("left"))+m,d=n.width()+l-2*m,u=parseFloat(a.css("left"))-m,c=u+m;o<l&&i.css({left:l,width:r+(o-l)}),o>u&&i.css({left:u,width:r+(o-u)}),s<c&&i.css({width:c-o}),s>d&&i.css({width:d-o})},onWhiskersResize:function(e,t){var i=this.get("box"),n=this.get("whiskers"),a=i.position().left-m,o=i.width(),r=a+o+2*m,s=t.position.left,l=t.size.width,d=s+l;s>a&&n.css({
left:a,width:l+(s-a)}),d<r&&n.css({width:r-s})},enforceModelConstraints:function(){function e(e,t){a[e]=a[t],i.set(e,a[t])}function t(t,i,n,o){a[t]>a[i]&&e(n,o)}var i=this.get("data"),n=["_0th","_25th","_50th","_75th","_100th"],a=i.getProperties(n);t("_0th","_25th","_25th","_0th"),t("_25th","_50th","_50th","_25th"),t("_50th","_75th","_50th","_75th"),t("_75th","_100th","_75th","_100th"),a._0th>=a._100th&&i.set("_100th",i.get("_0th")+.01)},updateModelValuesFromPixelPositions:function(){var e=this.get("pixelToModelCoords"),t=this.get("data"),i=this.get("box"),n=this.get("whiskers"),a=this.get("median"),o=i.position().left,r=o+i.width(),s=n.position().left,l=n.width()+s,d=a.position().left;t.setProperties({_0th:e(s),_25th:e(o),_50th:e(d),_75th:e(r),_100th:e(l)}),this.enforceModelConstraints(),this.redraw()},boxPlot:function(){return this.$().find(".box-plot")}.property(),box:function(){return this.$().find("#box")}.property(),whiskers:function(){return this.$().find("#whiskers")}.property(),median:function(){return this.$().find("#median")}.property(),currentQuestion:function(){return this.$().find(".current")}.property().volatile(),setupDebugSliders:function(){var e=this,t=function(t,i,n,a){var o=e.$().find(t),r=function(){var t=parseFloat(o.slider("value"));e.set(i,t)};o.slider({change:r,slide:r,min:n,max:a,step:.01,value:e.get(i)})};t("#location-slider","location",-3,3),t("#scale-slider","scale",0,3),t("#shape-slider","shape",0,10)},setupDOM:function(){function e(e){return function(){e.apply(n,arguments)}}this.updateCurrentQuestionText();var t=this.get("boxPlot");if(void 0!=window.G_vmlCanvasManager){var i=this.$().find("canvas")[0];i=c.default.recreateCanvasElement(i),window.G_vmlCanvasManager.initElement(i)}this.set("haveSetupDOM",!0),this.setupDebugSliders();var n=this,a=t.find("#box"),o=t.find("#whiskers").resizable({handles:"w,e",containment:"parent",resize:e(this.onWhiskersResize),stop:e(this.updateModelValuesFromPixelPositions)});t.find("#median").draggable({axis:"x",containment:a,stop:e(this.updateModelValuesFromPixelPositions)});var r=this,s=this.$().find("#mouse-cursor");t.mouseenter(function(e){s.show()}).mousemove(function(e){if(!r.get("doneClicking")){var i=e.pageX-t.offset().left;n.get("pixelToModelCoords")(i);s.css("left",i),r.setCurrentQuestionToMouseX(e),r.redraw()}}).mouseleave(function(e){s.hide()}),a.resizable({handles:"w,e",resize:e(this.onBoxResize),stop:e(this.updateModelValuesFromPixelPositions)});var l;a.draggable({axis:"x",containment:o,start:e(function(e,t){l=this.get("median").position().left}),drag:e(function(e,t){this.get("median").css("left",l-(t.originalPosition.left-t.position.left))}),stop:e(this.updateModelValuesFromPixelPositions)}),p&&(this.$().find(".DEBUG").show(),this.$().find("#mouse-cursor").remove(),this.$().find("#axis-label").hide(),this.$().find("#instructions").hide()),this.redraw()}})},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=i(2),o=n(a),r=i(14),s=n(r),l=i(1),d=n(l),u=i(24),c=i(20),g=(i(23),i(15));console.error("WEBPACKCONVERT: editing a card-rank to add cards doesn't seem to be working"),g.WidgetResultsViewRegistry.CardRank=g.WidgetResultsView.extend({templateName:"card-rank-results",classNames:["widget-results","card-rank"],content:void 0,cardTallies:function(){var e=this.get("content.perExpertData"),t=o.default.Set.create(),i=o.default.Set.create(),n={},a=/_radio$/;e.forEach(function(e){var r=e.data;for(var s in r)if(r.hasOwnProperty(s)&&"metadata"!==s&&!s.match(a)){var l=r[s];t.add(s),i.add(l),n.hasOwnProperty(s)||(n[s]={});var d=n[s][l];o.default.isNone(d)&&(d=0),d+=1,n[s][l]=d}});var r=i.toArray().sort(function(e,t){var i=parseInt(e),n=parseInt(t);return isNaN(i)?!isNaN(n)||e>t:!isNaN(n)&&i>n}),s=t.toArray().sort(),l=[];return s.forEach(function(e){var t=[{isACard:!0,card:e}];r.forEach(function(i){var a=n[e][i];o.default.isNone(a)&&(a=0),t.push({isACard:!1,tally:a,title:a.toString()+" experts ranked this card as #"+i})}),l.push(t)}),o.default.Object.create({columnLabels:r,rowLabels:s,rows:l})}.property("content.perExpertData")}),s.default.CardRankCard=o.default.View.extend({templateName:"card-rank-card",content:void 0,didInsertElement:function(){this._super();var e=this.$().closest(".widget.card-rank").find(".draggable-parent"),t=this.$().find(".card");t.draggable({revert:"invalid",helper:"clone",appendTo:e}),this.get("content.writein")||t.disableSelection()}}),s.default.CardRankContainer=o.default.View.extend({templateName:"card-rank-container",content:void 0,attributeBindings:["dataKey"],dataKey:function(){return this.get("content.dataKey")}.property("content.dataKey"),classNames:["container","clearfix"],classNameBindings:["content.allowOnlyOneCard","content.empty","content.initial","content.optional"],didInsertElement:function(){this._super();var e=this;this.$().droppable({hoverClass:"drophover",accept:function(t,i){return e.get("content.empty")||!e.get("content.allowOnlyOneCard")},drop:function(t,i){var n=i.draggable,a=o.default.View.views[n.closest(".ember-view").attr("id")].get("content"),r=o.default.View.views[n.closest(".container.ember-view").attr("id")].get("content.cards"),s=e.get("content.cards");r.removeObject(a),s.pushObject(a)}})}});var f=c.WidgetDefinition.extend({label:"untitled card",dataKey:function(){return this.get("label").replace(/\./g,"")}.property("label"),definition:void 0,hasDefinition:function(){var e=this.get("definition");return!(o.default.isNone(e)||e.length<1)}.property("definition"),popup:function(){return this.get("hasDefinition")?this.get("definition"):null}.property("label","definition"),writein:!1}),h=0,p=o.default.ArrayController.extend({onInit:function(){this.set("cards",o.default.A(this.get("cards"))),this.set("multipleChoiceNum",h++)}.on("init"),initial:!1,optional:!1,allowOnlyOneCard:!0,empty:function(){return this.get("cards.length")<1}.property("cards.length"),dataKey:void 0,cards:void 0,_stateSkipKeys:["cards"]}),m=c.WidgetDefinition.extend({radioButtonsAreOptional:!1,topLabel:"Biggest Item",bottomLabel:"Smallest Item",radioButtonLabel:"The value or importance of this factor is expected to:",cards:null,writeInCards:null,numCards:function(){return this.get("cards.length")+this.get("writeInCards.length")}.property("cards.length","writeInCards.length"),enableRadioButtonsOnDropTargets:function(){var e=this.get("radioButtons");return e&&e.get("length")>0}.property("radioButtons.length"),numCardsToAccept:"",acceptMoreThanNumCards:!0,allowEqualRanking:!1,disallowEqualRanking:function(){return!this.get("allowEqualRanking")}.property("allowEqualRanking"),onInit:function(){this.set("containers",o.default.A(this.get("containers"))),this.set("cards",o.default.A()),this.set("writeInCards",o.default.A())}.on("init"),initialCardsContainer:function(){var e=this.get("cards").slice(),t=this.get("randomizeCardOrder");return t&&(e=d.default.shuffleArray(e)),p.create({cards:e,allowOnlyOneCard:!1,initial:!0})}.property("cards.@each","randomizeCardOrder"),unusedCards:function(){var e=o.default.Set.create();this.get("containers").forEach(function(t){t.get("cards").forEach(function(t){e.addObject(t)})});var t=[];return this.get("cards").forEach(function(i){e.contains(i)||t.push(i)}),t}.property("cards","containers.@each.@each"),containers:void 0,numContainers:function(){var e=parseInt(this.get("numCardsToAccept")),t=this.get("acceptMoreThanNumCards");return void 0===e||isNaN(e)||e<1||t?this.get("numCards"):e}.property("numCards","numCardsToAccept","acceptMoreThanNumCards"),createAndDestroyContainersAsNeeded:function(){var e=this.get("numContainers"),t=this.get("containers"),i=this.get("containers.length");if(i>e)for(var n=i;n>e;n--)t.popObject();else if(i<e)for(var n=i;n<e;n++)t.pushObject(p.create({dataKey:n+1,cardRank:this,allowOnlyOneCardBinding:"cardRank.disallowEqualRanking"}));var a=parseInt(this.get("numCardsToAccept"));o.default.isNone(a)&&(a=e);this.get("acceptMoreThanNumCards");t.forEach(function(e,t){var i=t>=a;e.set("optional",i)})}.observes("numContainers","numCardsToAccept","acceptMoreThanNumCards")});u.Widget.register("card-rank",{prettyName:"Card Rank",templateName:"card-rank",widgetResults:g.WidgetResultsViewRegistry.CardRank,definitionSchema:{model:m,label:{accessor:c.WidgetDefinition.ChildNode("label"),type:"Text"},cards:{type:"HasMany",prettyName:"Card",emphasizeWhenEmpty:!0,accessor:c.WidgetDefinition.HasMany("card",{model:f,label:{accessor:c.WidgetDefinition.Contents()},definition:{accessor:c.WidgetDefinition.Attr("definition"),prettyName:"Definition"}})},randomizeCardOrder:{type:"Boolean",prettyName:"Randomize Card Order",accessor:c.WidgetDefinition.Attr("randomize-card-order"),helpText:"Shuffle the cards for each person viewing the elicitation"},topLabel:{accessor:c.WidgetDefinition.Attr("top-label"),prettyName:"Top Label"},bottomLabel:{accessor:c.WidgetDefinition.Attr("bottom-label"),prettyName:"Bottom Label"},allowWriteInCards:{accessor:c.WidgetDefinition.Attr("allow-writeins"),prettyName:"Allow Write-In Cards",helpText:"Allow experts to add their own cards to the set being ranked.",type:"Boolean"},numCardsToAccept:{accessor:c.WidgetDefinition.Attr("num-containers"),prettyName:"Number of Rankings Requested",helpText:"Number of cards experts are asked to rank. If this is blank, the number of required cards will equal the number of defined cards."},acceptMoreThanNumCards:{accessor:c.WidgetDefinition.Attr("allow-more-than-num-containers"),prettyName:"Allow optional rankings beyond requested",type:"Boolean"},allowEqualRanking:{accessor:c.WidgetDefinition.Attr("allow-equal-ranking"),prettyName:"Allow Equal Ranking of Cards",helpText:"Allow experts to rank multiple cards as equal (i.e. allow more than one card in each drop target).",type:"Boolean"},radioButtons:{type:"HasMany",prettyName:"Radio Button",accessor:c.WidgetDefinition.HasMany("radio-button",{model:c.WidgetDefinition.extend({label:"Decrease"}),label:{accessor:c.WidgetDefinition.Contents()}})},radioButtonLabel:{accessor:c.WidgetDefinition.ChildNode("radio-button-label"),prettyName:"Header for Radio Buttons",type:"Text"},radioButtonsAreOptional:{accessor:c.WidgetDefinition.Attr("radio-buttons-are-optional"),prettyName:"Radio Buttons Are Optional",helpText:"Don't harrass experts if they don't fill in a radio buttonn",type:"Boolean"}},actions:{addAWriteInCard:function(){this.appendWriteInCard()}},appendWriteInCard:function(e){e=e?e:"";var t=f.create({label:e,writein:!0});return this.get("definition.initialCardsContainer.cards").pushObject(t),this.get("definition.writeInCards").pushObject(t),t},rerenderIfCardsChange:function(){this.rerender()}.observes("definition.cards.@each","definition.containers.@each"),serializeData:function(e,t){var i=this.$(),n=parseInt(this.get("definition.numCardsToAccept"));if(isNaN(n)||n<1)i.find(".container.initial .card").length&&t.pushObject("One or more cards haven't been used");else{var a=i.find(".container").not(".initial").find(".card").length;a<n&&t.pushObject("Expected more than "+n+" cards to be used, but only "+a+" cards were used.")}var o=this.get("definition.enableRadioButtonsOnDropTargets"),r=!1;i.find(".card").each(function(){var t=$(this),i=t.closest(".container"),n=d.default.escapeForEmberProperty(t.attr("dataKey")),a=i.attr("dataKey");if(e.set(n,a),o&&!i.hasClass("initial")){var s=t.closest("tr").find("input[type='radio']:checked");0==s.length&&(r=!0);var l=n+"_radio";e.set(l,s.val())}}),r&&!this.get("definition.radioButtonsAreOptional")&&t.pushObject("One or more radio buttons weren't set")},resumeFromSerializedData:function(e){function t(e){return"_radio"==e.slice(-6)}var i=this.get("definition.enableRadioButtonsOnDropTargets"),n=o.default.keys(e).filter(function(e){return"metadata"!=e}),a={};this.get("definition.cards.content").forEach(function(e){var t=d.default.escapeForEmberProperty(e.get("dataKey"));a[t]=e});var r={};this.get("definition.containers").forEach(function(e){r[e.get("dataKey")]=e}),console.log("cardNameToCard: ",a),console.log("containerNameToContainer: ",r);var s=this.get("definition.initialCardsContainer");n.filter(function(e){return!t(e)}).forEach(function(t){var i=a[t];o.default.isNone(i)&&(console.log("Creating a write-in card for ",t),i=this.appendWriteInCard(t),a[t]=i);var n=o.default.get(e,t),l=r[n];s.get("cards").removeObject(i),l.get("cards").pushObject(i)}.bind(this)),i&&n.filter(t).forEach(function(t){function i(){var e=$(".card").toArray().find(function(e){return $(e).attr("dataKey")===l}),t=$(e).closest("tr").find("input[type='radio']").filter("[value='"+s+"']");t.prop("checked",s)}var n=t.slice(0,-6),r=a[n],s=o.default.get(e,t),l=r.get("dataKey");window.setTimeout(i,250)})}})},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=i(2),o=(n(a),i(14)),r=n(o),s=i(1),l=(n(s),i(24)),d=i(20),u=i(23);l.Widget.register("dropdown",{prettyName:"Dropdown",value:null,templateName:"dropdown",dataModel:u.WidgetData.extend({selection:null}),definitionSchema:{model:d.WidgetDefinition.extend({writein:!0,placeholder:"Select one...",populateWithDiscussionMembers:!0}),label:{accessor:d.WidgetDefinition.ChildNode("label"),type:"Text"},populateWithDiscussionMembers:{accessor:d.WidgetDefinition.Attr("populate-with-discussion-members"),type:"Boolean",prettyName:"Populate dropdown with participant names"},writein:{accessor:d.WidgetDefinition.Attr("writein"),type:"Boolean",prettyName:"Allow write-in answers"},selections:{type:"HasMany",prettyName:"Selection",accessor:d.WidgetDefinition.HasMany("selection",{model:d.WidgetDefinition.extend({label:"an item in the list"}),label:{accessor:d.WidgetDefinition.Contents()}})},placeholder:{accessor:d.WidgetDefinition.Attr("placeholder")}},setupDOM:function(){if(this.get("definition.writein")){var e=this.$().find("select").combobox({});this.set("combobox",e)}},selections:function(){var e=this.get("definition.selections").map(function(e){return e.get("label")});return this.get("definition.populateWithDiscussionMembers")&&r.default.get("experts").forEach(function(t){e.push(t)}),e}.property("elicitation.experts.@each","definition.selections.@each.label","definition.populateWithDiscussionMembers"),rerenderOnChange:function(){this.rerender()}.observes("definition.writein","definition.placeholder"),serializeData:function(e,t){var i;i=this.get("definition.writein")?this.$().find("input.ui-autocomplete-input").val():this.get("data.selection"),i||t.pushObject("You need to select an item from the dropdown."),e.set("selection",i)},resumeFromSerializedData:function(e){if(e){var t=e.selection;this.get("definition.writein")?this.$().find("input.ui-autocomplete-input").val(t):this.set("data.selection",t)}}}),function(e){e.widget("ui.combobox",{_create:function(){var t,i=this,n=!1,a=this.element.hide(),o=a.children(":selected"),r=o.val()?o.text():"",s=this.wrapper=e("<span>").addClass("ui-combobox").insertAfter(a);t=e("<input>").appendTo(s).val(r).attr("title","").addClass("ui-state-default ui-combobox-input").autocomplete({delay:0,minLength:0,source:function(t,i){var n=new RegExp(e.ui.autocomplete.escapeRegex(t.term),"i");i(a.children("option").map(function(){var i=e(this).text();if(this.value&&(!t.term||n.test(i)))return{label:i.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+e.ui.autocomplete.escapeRegex(t.term)+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>"),value:i,option:this}}))},select:function(e,t){t.item.option.selected=!0,i._trigger("selected",e,{item:t.item.option})},change:function(e,t){!t.item}}).addClass("ui-widget ui-widget-content ui-corner-left"),t.data("ui-autocomplete")._renderItem=function(t,i){return e("<li>").append("<a>"+i.label+"</a>").appendTo(t)},e("<a>").attr("tabIndex",-1).attr("title","Show All Items").tooltip().appendTo(s).button({icons:{primary:"ui-icon-triangle-1-s"},text:!1}).removeClass("ui-corner-all").addClass("ui-corner-right ui-combobox-toggle").mousedown(function(){n=t.autocomplete("widget").is(":visible")}).click(function(){t.focus(),n||t.autocomplete("search","")}),t.tooltip({tooltipClass:"ui-state-highlight"})},_destroy:function(){this.wrapper.remove(),this.element.show()}})}(jQuery)},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=i(2),o=n(a),r=i(24),s=i(20);r.Widget.register("image-in-elicitation",{prettyName:"Image",templateName:"image",definitionSchema:{model:s.WidgetDefinition.extend({label:""}),image:{accessor:s.WidgetDefinition.Attr("image-in-elicitation-id"),prettyName:"Upload an Image",type:"Image"},label:{accessor:s.WidgetDefinition.ChildNode("label"),prettyName:"Caption",type:"Text"},alignCenter:{accessor:s.WidgetDefinition.Attr("align-center"),prettyName:"Align Center",type:"Boolean"},linkToURL:{accessor:s.WidgetDefinition.Attr("href"),prettyName:"Link to URL"},thumbnail:{accessor:s.WidgetDefinition.Attr("is-thumbnail"),prettyName:"Thumbnail",type:"Boolean"},imageURL:{accessor:s.WidgetDefinition.Attr("src"),prettyName:"Manual Image URL (instead of upload)"}},linkToURL:function(){var e=this.get("definition.linkToURL");return!o.default.isNone(e)&&e.length>1?e:this.get("imageURLFullSize")}.property("definition.linkToURL","imageURLFullSize"),imageURLFullSize:function(){var e=this.get("baseImageURL");if(!o.default.isNone(e))return e+"&size=original"}.property("baseImageURL"),imageURL:function(){var e=this.get("baseImageURL");return this.get("definition.thumbnail")?e+"&size=thumbnail":e}.property("baseImageURL","definition.thumbnail"),baseImageURL:function(){var e=this.get("definition.imageURL");if(!o.default.isNone(e)&&e.length>0)return e.replace("[[PERSON_ID]]",encodeURIComponent(this.get("elicitation.personID")));var t=this.get("definition.image");if(!o.default.isNone(t))return this.get("elicitation.imageURL")+"&id="+t}.property("definition.image","definition.imageURL"),imageMissingMessage:function(){var e=Math.floor(4*Math.random());return 0==e?"You step in the stream,\nbut the water has moved on.\nNo image remains.":1==e?"Is what you seek reality? Or only its image?":2==e?"The image you seek\ncannot be located but\nendless others exist":e>=3?"Only an empty glass need be filled.":void 0}.property(),qualifications:[]})},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=i(2),o=(n(a),i(24)),r=i(20),s=0;o.Widget.register("likert",{likertNum:null,prettyName:"Likert Scale",initWidget:function(){this._super(),this.set("likertNum",s++)},templateName:"likert",definitionSchema:{model:r.WidgetDefinition.extend({label:"Authoring elicitations makes me feel mushy inside.",stronglyNegativeLabel:"Strongly Disagree",negativeLabel:"Disagree",neutralLabel:"Not Sure",positiveLabel:"Agree",stronglyPositiveLabel:"Strongly Agree"}),label:{accessor:r.WidgetDefinition.ChildNode("label"),type:"Text"},stronglyNegativeLabel:{accessor:r.WidgetDefinition.Attr("strongly-negative-label"),prettyName:"Strongly Negative Label"},negativeLabel:{accessor:r.WidgetDefinition.Attr("negative-label"),prettyName:"Negative Label"},neutralLabel:{accessor:r.WidgetDefinition.Attr("neutral-label"),prettyName:"Neutral Label"},positiveLabel:{accessor:r.WidgetDefinition.Attr("positive-label"),prettyName:"Positive Label"},stronglyPositiveLabel:{accessor:r.WidgetDefinition.Attr("strongly-positive-label"),prettyName:"Strongly Positive Label"}},serializeData:function(e,t){var i=this.$().find("input[type='radio']:checked").val();e.set("agreement",i),i||t.pushObject("You didn't say how you felt about one of the statements")},resumeFromSerializedData:function(e){if(e&&e.agreement){var t=this.$().find("input[type='radio']").toArray().find(function(t){return $(t).val()===e.agreement});$(t).prop("checked",!0)}}})},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=i(2),o=n(a),r=i(24),s=i(20),l=i(23),d=0;r.Widget.register("multiple-choice",{prettyName:"Multiple Choice",value:null,templateName:"multiple-choice",dataModel:l.WidgetData.extend({writein:""}),definitionSchema:{model:s.WidgetDefinition.extend({writein:!1}),label:{accessor:s.WidgetDefinition.ChildNode("label"),type:"Text"},writein:{accessor:s.WidgetDefinition.Attr("writein"),type:"Boolean",prettyName:"Append a write-in choice"},choices:{type:"HasMany",prettyName:"Choice",emphasizeWhenEmpty:!0,accessor:s.WidgetDefinition.HasMany("choice",{model:s.WidgetDefinition.extend({label:"One choice amongst many",htmlID:function(){return this.get("dataKey")}.property("dataKey")}),label:{accessor:s.WidgetDefinition.Contents()}})}},initWidget:function(){this._super(),this.set("multipleChoiceNum",d++)},setupDOM:function(){},serializeData:function(e,t){var i=this.$().find("input[type='radio']:checked").val();e.set("choice",i),i||t.pushObject("You didn't select one of the multiple choices")},resumeFromSerializedData:function(e){if(e&&e.choice){var t=e.choice,i=this.$().find("input[type='radio']").toArray().find(function(e){return $(e).val()===t});o.default.isNone(i)&&this.get("definition.writein")&&(i=$(".writein input[type='radio']"),this.set("data.writein",t)),$(i).prop("checked",!0)}}})},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){return{type:"HasMany",prettyName:"Custom Dropdown #"+e+" Choice",accessor:u.WidgetDefinition.HasMany("custom-dropdown-choice-"+e,{model:u.WidgetDefinition.extend({label:"dropdown choice"}),label:{accessor:u.WidgetDefinition.Attr("label"),type:"String"}}),category:"Custom Dropdowns"}}var o=i(2),r=n(o),s=i(1),l=n(s),d=i(24),u=i(20),c=i(23),g=i(36),f=0,h=r.default.Object.extend({cells:null,labelBinding:"definition.label",multipleChoiceNum:void 0,multipleChoiceName:function(){return"multiple-choice-table-"+this.get("multipleChoiceNum")}.property("multipleChoiceNum"),init:function(){this.set("multipleChoiceNum",f++)},radioChoice:void 0}),p=r.default.Object.extend({checkBoxBinding:"col.definition.checkBox",textEntryBinding:"col.definition.textEntry",radioButtonBinding:"col.definition.radioButton",choiceBinding:"col.definition.label",dropDownBinding:"col.definition.dropDown",col:null,row:null,value:!1}),m=r.default.Object.extend({reorderedRows:function(){var e=this.get("rows");return this.get("dataModel.definition.randomizeRowOrder")?l.default.shuffleArray(r.default.A(e.slice())):e}.property("rows.@each","dataModel.definition.randomizeRowOrder")}),v=c.WidgetData.extend({init:function(){this._super(),this.set("table",c.WidgetData.CreateTable({dataModel:this,rowDefinitionsBinding:"dataModel.definition.rows",colDefinitionsBinding:"dataModel.definition.choices",rowModel:h,cellModel:p,tableModel:m}))}}),y=g.RadioButtonGroup.extend({templateName:"multiple-choice-table-row",tagName:"tr",row:void 0,attributeBindings:["valign"],valign:"top",nameBinding:"row.multipleChoiceName",valueBinding:"row.radioChoice"});d.Widget.register("multiple-choice-table",{RowView:y,prettyName:"Multiple Choice Table",value:null,templateName:"multiple-choice-table",dataModel:v,RadioButton:r.default.Checkbox.extend({type:"radio"}),definitionSchema:{model:u.WidgetDefinition.extend({label:"Select your choices for these questions"}),label:{accessor:u.WidgetDefinition.ChildNode("label"),type:"Text"},choices:{type:"HasMany",prettyName:"Choice",emphasizeWhenEmpty:!0,accessor:u.WidgetDefinition.HasMany("choice",{model:u.WidgetDefinition.extend({label:"One Choice",htmlID:function(){return this.get("dataKey")}.property("dataKey"),checkBox:function(e,t){return arguments.length>1&&1==t&&this.set("choiceType","checkbox"),"checkbox"===this.get("choiceType")}.property("choiceType"),radioButton:function(e,t){return"radio"===this.get("choiceType")}.property("choiceType"),textEntry:function(e,t){return"text"===this.get("choiceType")}.property("choiceType"),dropDown:function(e,t){return"custom-dropdown-"==this.get("choiceType").slice(0,-1)}.property("choiceType"),hihi:function(){console.log("hihi!",this.get("choiceType"))}.property().volatile(),dropDownChoices:function(e,t){var i=this.get("choiceType").slice(-1);return this.get("parent").get("customDropDownChoices"+i).mapProperty("label").insertAt(0,"")}.property("choiceType","parent.customDropDownChoices1.@each.label","parent.customDropDownChoices2.@each.label","parent.customDropDownChoices3.@each.label","parent.customDropDownChoices4.@each.label"),choiceType:"radio"}),label:{accessor:u.WidgetDefinition.ChildNode("label")},checkBox:{prettyName:"Check Box",type:"Boolean",accessor:u.WidgetDefinition.Attr("check-box"),visible:!1,dontSerialize:!0},choiceType:{prettyName:"Type of choice",type:"Enum",values:[{value:"radio",label:"Radio"},{value:"checkbox",label:"Check Box"},{value:"text",label:"Text Entry"},{value:"custom-dropdown-1",label:"Custom Dropdown #1"},{value:"custom-dropdown-2",label:"Custom Dropdown #2"},{value:"custom-dropdown-3",label:"Custom Dropdown #4"},{value:"custom-dropdown-4",label:"Custom Dropdown #4"}],accessor:u.WidgetDefinition.Attr("choice-type")}})},rows:{type:"HasMany",prettyName:"Row",emphasizeWhenEmpty:!0,accessor:u.WidgetDefinition.HasMany("row",{model:u.WidgetDefinition.extend({label:"untitled row"}),label:{accessor:u.WidgetDefinition.ChildNode("label")}})},randomizeRowOrder:{type:"Boolean",prettyName:"Randomize Row Order",accessor:u.WidgetDefinition.Attr("randomize-row-order"),helpText:"Randomize the order of rows for each person viewing the elicitation"},customDropDownChoices1:a("1"),customDropDownChoices2:a("2"),customDropDownChoices3:a("3"),customDropDownChoices4:a("4")},showTableFooter:function(){return this.get("definition.rows.length")>=8}.property("definition.rows.length"),serializeData:function(e,t){e.set("rows",this.get("data.table.rows").map(function(e){var i=e.get("radioChoice"),n=c.WidgetData.create({choice:i,dataKeyText:e.get("label")}),a=e.get("cells"),o=function(e){var t=l.default.escapeForEmberProperty(e.get("choice")),i=e.get("value");n.set(t,i)};return a.filterBy("checkBox").forEach(o),a.filterBy("dropDown").forEach(o),a.filterProperty("textEntry").forEach(function(e){var t=l.default.escapeForEmberProperty(e.get("choice")),i=e.get("value");0==i&&(i=""),n.set(t,i)}),r.default.isNone(i)&&a.filterProperty("radioButton").length>0&&t.pushObject("You didn't select a choice for row '"+e.get("definition.label")+"'"),n}))}})},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.RadioButtonGroup=t.RadioButton=void 0;var a=i(2),o=n(a),r=o.default.get,s=(o.default.getPath,o.default.set),l=(o.default.String.fmt,o.default.View.extend({init:function(){this._super()}})),d=l.extend({attributeBindings:["disabled","type","name","value","checked"],classNames:["ember-radio-button"],value:null,selectedValue:null,isDisabled:!1,checked:!1,tagName:"input",type:"radio",selectedValueChanged:o.default.observer(function(){var e=r(this,"selectedValue");o.default.isEmpty(e)||r(this,"value")!==e?s(this,"checked",!1):s(this,"checked",!0)},"selectedValue"),checkedChanged:o.default.observer(function(){this._updateElementValue()},"checked"),init:function(){this._super(),this.selectedValueChanged()},change:function(){s(this,"checked",this.$().prop("checked")),o.default.run.once(this,this._updateElementValue)},_updateElementValue:function(){r(this,"checked")&&s(this,"selectedValue",r(this,"value"))}}),u=l.extend({classNames:["ember-radio-button-group"],attributeBindings:["name:data-name"],name:o.default.required(),value:null,init:function(){this._super()},RadioButton:o.default.computed(function(){return d.extend({group:this,selectedValueBinding:"group.value",nameBinding:"group.name"})})});t.RadioButton=d,t.RadioButtonGroup=u},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=i(2),o=(n(a),i(24)),r=i(20);o.Widget.register("paragraph",{prettyName:"Paragraph",templateName:"paragraph",definitionSchema:{model:r.WidgetDefinition.extend({label:"##This is a Header##\nWith a block of text under it demonstrating a few features of Markdown formatting, including:\n\n- A link to [another website](http://www.google.com)\n- *Italicized text*\n- **Bold text**\n- Support for<sup>superscript</sup>\n\nAnd another paragraph, with a [[term definition]]."}),label:{accessor:r.WidgetDefinition.ChildNode("label"),type:"Text"}},qualifications:[]})},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){return function(t){this.runEventHandler(e,t)}}function o(e){function t(t){return e.get("widgets").findBy("dataKey",t)}function i(t){return e.get("pagesController.content")[t]}var n={getValueOfVariable:function(t){return e.get("variableScope")[t]},setCustomVariable:function(t,i){var n=e.get("variables").findBy("name",t);if(n&&n.get("widget"))throw"Sorry, cannot override a variable defined by a widget, setCustomVariable() can only be used with new variable names";e.get("customScriptingVariables").pushObject(s.default.Object.create({name:t,value:i}))},setWidgetLabel:function(e,t){this.setWidgetProperty(e,"definition.label",t)},getWidgetLabel:function(e){return this.getWidgetProperty(e,"definition.label")},gotoPage:function(t){if(t<1)console.warn("Pages start at page 1, not page 0");else{var n=i(t-1);s.default.isNone(n)?console.warn("Page number "+t+" doesn't seem to exist, note that the first page is pageNum=1"):e.get("pagesController").gotoPage(n)}},getElicitedData:function(){return e.getSerializedData()},getElicitatedDataFor:function(t){return e.getSerializedDataFor(t)},setWidgetProperty:function(e,i,n,a){void 0===a&&(a=!0);var o=t(e);if(o.set(i,n),a)try{o.redraw()}catch(e){console.warn("Exception trying to redraw widget after customScripting.api.setWidgetProperty(): ",e),console.warn("Trying to call widget.redraw() again in 100ms"),s.default.run.next(function(){o.redraw()})}},getWidgetProperty:function(e,i){return t(e).get(i)},findWidgetID:function(e,t){return i(e).get("widgets").get(t).get("dataKey")},printWidgetProperties:function(e,i){var n=t(e),a=n.stateGetPropertyNames(i,!0),o="Some properties for widget with label "+n.get("definition.label")+":\n",r="\n\nYou can use these properties with api.setWidgetProperty('"+e+"', 'some.property.here', 'new value') as well as api.getWidgetProperty('"+e+"', 'some.property.here'), but please note that widget properties may change over time, might disappear, and are NOT OFFICIALLY SUPPORTED.";return console.log(o+a.join("\n")+r),a},printAllWidgetIDs:function(){var t=0,i="",n=[];return e.get("pagesController.content").forEach(function(e){t++,i+="Page "+t+", '"+e.get("title")+"':\n",e.get("widgets").forEach(function(e){var t=e.get("dataKey");i+="\t"+t+"   '"+e.get("templateName")+": "+e.get("definition.label")+"'\n",n.push(t)}),i+="\n"}),console.log(i+"\n\n(PS: WidgetIDs are the long numbers)"),n}};return n}var r=i(2),s=n(r),l=i(24),d=i(20);l.Widget.register("custom-scripting",{prettyName:"Custom Scripting",templateName:"custom-scripting",definitionSchema:{model:d.WidgetDefinition.extend({label:"explain what the script does here",beforeEnteringPage:"// see http://wiki.nearzero.org/elicitation-authoring/for-developers\n// for examples and (some) documentation\n\nalert('hello world!');\n",beforeExitingPage:"",activeEventHandlers:function(){return["beforeEnteringPage","beforeExitingPage"].map(function(e){return{name:e,handler:this.get(e)}}.bind(this)).filter(function(e){return""!=e.handler.trim()})}.property("beforeEnteringPage","beforeExitingPage")}),label:{accessor:d.WidgetDefinition.ChildNode("label"),type:"Text",prettyName:"Description of code"},beforeEnteringPage:{accessor:d.WidgetDefinition.ChildNode("beforeEnteringPage"),type:"Text",prettyName:"BeforeEnteringPage(api, unsupported) {",helpText:"The JavaScript in BeforeEnteringPage is executed before the page in which this widget resides is switched to. You can use the 'Preview' button to test your custom script in actual usage, or just click the test button to manually execute your script.\n\nYour code has access to an 'api' variable, which is an object with functions you can use for scripting the elicitation. You can explore this API by opening your javascript console and exploring customScripting.api . You can also directly access the raw elicitation to do anything you want by using unsupported.elicitation in your script, but in general this is not recommended."
},beforeExitingPage:{accessor:d.WidgetDefinition.ChildNode("beforeExitingPage"),type:"Text",prettyName:"BeforeExitingPage(api, unsupported) {",helpText:"See help for BeforeEnteringPage for details on using the custom scripting feature"}},beforeEnteringPage:a("beforeEnteringPage"),beforeExitingPage:a("beforeExitingPage"),conditionallyHidden:function(){return!0}.property(),serializeData:function(e,t){},init:function(){this._super(),debug.customScriptingWidget=this,window.customScripting={api:o(this.get("elicitation"))}},editors:{beforeEnteringPage:null,beforeExtingPage:null},beforeEnteringPageChanged:function(){if(this.editors.beforeEnteringPage){var e=this.get("definition.beforeEnteringPage");e!=this.editors.beforeEnteringPage.getValue()&&(console.log("Updating editor from property"),this.editors.beforeEnteringPage.setValue(e))}}.observes("definition.beforeEnteringPage"),beforeExitingPageChanged:function(){if(this.editors.beforeExitingPage){var e=this.get("definition.beforeExitingPage");e!=this.editors.beforeExitingPage.getValue()&&this.editors.beforeExitingPage.setValue(e)}}.observes("definition.beforeExitingPage"),setupDOM:function(){var e=this;if(this.get("elicitation.allowEditing")){var t;!function(){var i=function(e){var i=t.$().find(".script-editor#"+e)[0],n=CodeMirror(i,{lineNumbers:!0,viewportMargin:1/0,value:t.get("definition").get(e)});return n.on("change",function(){t.get("definition").set(e,n.getValue())}),n};t=e,debug.widgie=e,s.default.run.later(e,function(){this.editors.beforeEnteringPage=i("beforeEnteringPage"),this.editors.beforeExitingPage=i("beforeExitingPage")},750)}()}},runEventHandler:function(e,t){var i=this.get("definition").get(e);if(""!=i.trim()){var n=this.get("elicitation"),a={page:t,elicitation:n},r=o(n);window.customScripting.lastScriptRun={name:e,runItAgain:function(){this.runEventHandler(e,t)},sourceCode:i,api:r,unsupported:a,exception:null};try{var s=new Function("api","unsupported",i);s(r,a)}catch(t){console.error("Exception in custom script for "+e+":\n",t),console.warn("In custom script:\n",i),window.customScripting.lastScriptRun.exception=t,console.warn("See window.customScripting.lastScriptRun.exception for details")}}},actions:{testEventHandler:function(e){this.runEventHandler(e,"noPageDefinedOops")}}})},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=i(2),o=n(a),r=i(1),s=n(r),l=i(24),d=i(20);l.Widget.register("slider-allocation",{prettyName:"Slider Allocation",value:null,templateName:"slider-allocation",definitionSchema:{label:{accessor:d.WidgetDefinition.ChildNode("label"),type:"Text"},totalAllocation:{accessor:d.WidgetDefinition.Attr("total-allocation"),prettyName:"Allocation",type:"String"},leftLabel:{accessor:d.WidgetDefinition.ChildNode("left-label"),prettyName:"Left Item"},rightLabel:{accessor:d.WidgetDefinition.ChildNode("right-label"),prettyName:"Right Item"},unitSuffix:{accessor:d.WidgetDefinition.Attr("unit-suffix"),prettyName:"Units",helpText:"Units for the value being allocated, e.g. the 'kg' in 50kg"},unitPrefix:{accessor:d.WidgetDefinition.Attr("unit-prefix"),prettyName:"Prefix for Units",helpText:"Prefix to the value being allocated, e.g. the '$' in $50m"},model:d.WidgetDefinition.extend({label:"How would you spend a special allocation of $100m?",totalAllocation:100,unitPrefix:"$",unitSuffix:"m",leftLabel:"Candy",rightLabel:"Toothpaste"})},setupDOM:function(){var e=this.$().find("#jquery-slider"),t=this,i=function(){t.redraw()};e.slider({change:i,slide:i,min:0,max:1,step:.01,value:.5}),this.set("slider",e)},redraw:function(){var e=this.get("slider");if(!o.default.isNone(e)){var t=this.get("definition.totalAllocation"),i=parseFloat(e.slider("value")),n=((1-i)*t).toFixed(1);this.set("data.leftValue",n);var a=(i*t).toFixed(1);this.set("data.rightValue",a)}}.observes("definition.totalAllocation","slider"),serializeData:function(e,t){var i=s.default.escapeForEmberProperty(this.get("definition.leftLabel")),n=s.default.escapeForEmberProperty(this.get("definition.rightLabel"));e.set(i,parseFloat(this.get("data.leftValue"))),e.set(n,parseFloat(this.get("data.rightValue")))},afterStateResume:function(){var e=this.get("slider");if(!o.default.isNone(e)){var t=parseFloat(this.get("data.leftValue")),i=parseFloat(this.get("data.rightValue")),n=t/(t+i);e.slider("value",n)}}})},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=i(2),o=n(a),r=i(14),s=n(r),l=i(1),d=n(l),u=i(24),c=i(20),g=i(23);s.default.TabularInputTextField=o.default.TextField.extend({widget:void 0,row:void 0,focusIn:function(e){var t=this.get("widget"),i=t.get("data.rows"),n=this.get("row");i.indexOf(n)>=i.get("length")-1&&t.addNewRow()}}),u.Widget.register("tabular-input",{prettyName:"Tabular Input",templateName:"tabular-input",dataModel:g.WidgetData.extend({rows:void 0,init:function(){this._super(),this.set("rows",o.default.ArrayController.create({content:[]}))},appendRow:function(e){var t=this.get("rows"),i=e.map(function(e){return o.default.Object.create({text:""})}),n=o.default.ArrayController.create({content:i,columnsBinding:"content"});t.pushObject(n)}}),definitionSchema:{model:c.WidgetDefinition.extend({label:"Who else should complete this elicitation?"}),label:{accessor:c.WidgetDefinition.ChildNode("label"),type:"Text"},columns:{type:"HasMany",emphasizeWhenEmpty:!0,prettyName:"Column",accessor:c.WidgetDefinition.HasMany("column",{model:c.WidgetDefinition.extend({label:"untitled column"}),label:{accessor:c.WidgetDefinition.Contents()}})}},addNewRow:function(){var e=this.get("data");e.appendRow(this.get("definition.columns")),window.debugWidget=this},emptyContentWhenColumnsChange:function(){this.get("data.rows").clear(),this.addNewRow()}.observes("definition.columns.length"),serializeData:function(e,t){var i=this.get("definition.columns").map(function(e){return d.default.makeDataKeyFromText(e.get("label"))});this.get("data.rows").forEach(function(t,n){t.get("columns").forEach(function(t,a){var o=t.get("text"),r=i[a],s=d.default.escapeForEmberProperty(r+"_"+n.toString());e.set(s,o)})})}})},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=i(2),o=(n(a),i(24)),r=i(20);o.Widget.register("text-area",{prettyName:"Text Area",templateName:"text-area",definitionSchema:{model:r.WidgetDefinition.extend({numRows:4,optional:!0}),label:{accessor:r.WidgetDefinition.ChildNode("label"),type:"Text"},numRows:{accessor:r.WidgetDefinition.Attr("num-rows"),type:"String",prettyName:"# of Lines of Text"},placeholder:{accessor:r.WidgetDefinition.Attr("placeholder"),type:"String",prettyName:"Placeholder Text"},optional:{accessor:r.WidgetDefinition.Attr("optional"),type:"Boolean",prettyName:"Response is optional"}},serializeData:function(e,t){var i=this.get("data.text");i||this.get("definition.optional")||t.pushObject("A text area is still blank"),e.set("text",i)}})},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=i(2),o=n(a),r=i(1),s=n(r),l=i(24),d=i(20);l.Widget.register("text-box",{prettyName:"Number Box",templateName:"text-box",definitionSchema:{model:d.WidgetDefinition.extend({askForUncertaintyRange:!0,label:"How many jellybeans are in the jar?",uncertaintyRangeLabel:"Indicate an uncertainty range for your estimate:",uncertaintyRangeWidth:1}),label:{accessor:d.WidgetDefinition.ChildNode("label"),type:"Text"},askForUncertaintyRange:{accessor:d.WidgetDefinition.Attr("ask-for-uncertainty-range"),type:"Boolean",prettyName:"Ask for an uncertainty range"},uncertaintyRangeWidth:{accessor:d.WidgetDefinition.Attr("uncertainty-range-width"),prettyName:"Width of Uncertainty Range",helpText:"The uncertainty range width determines the upper and lower bounds of the uncertainty range slider. Say the user enters 5 and you have set the uncertainty range width to 2: then the lower bound of the slider will be 5-2=3, and the upper bound will be 5+2=7."},uncertaintyRangeLabel:{accessor:d.WidgetDefinition.ChildNode("uncertainty-range-label"),prettyName:"Label for Uncertainty Range",type:"Text",visibility:"askForUncertaintyRange"},min:{accessor:d.WidgetDefinition.Attr("min"),prettyName:"Min Value Allowed",helpText:"Smallest value allowed. If blank, no min."},max:{accessor:d.WidgetDefinition.Attr("max"),prettyName:"Max Value Allowed",helpText:"Largest value allowed. If blank, no max."},unitSuffix:{accessor:d.WidgetDefinition.Attr("unit-suffix"),prettyName:"Units",helpText:"Units for the number, e.g. the 'kg' in 50kg"},unitPrefix:{accessor:d.WidgetDefinition.Attr("unit-prefix"),prettyName:"Prefix for Units",helpText:"Prefix to the number, e.g. the '$' in $50m"},validation:{accessor:d.WidgetDefinition.Attr("validation"),category:"Validation"},validationMessage:{accessor:d.WidgetDefinition.Attr("validationMessage"),prettyName:"Validation Message",category:"Validation"}},setupDOM:function(){if(this.get("definition.askForUncertaintyRange")){var e=this.$().find("#jquery-slider"),t=this.get("data"),i=function(){var i=t.get("text-value"),n=e.slider("values",0);n>i&&(n=i,e.slider("values",0,n)),t.set("uncertaintyRangeLower",n);var a=e.slider("values",1);a<i&&(a=i,e.slider("values",1,a)),t.set("uncertaintyRangeUpper",a)};e.slider({change:i,slide:i,min:0,max:1,range:!0,step:.01,values:[.25,.75]}),this.set("slider",e)}},reactToTextChanging:function(){var e=this.get("data.text"),t=this.get("slider"),i=parseFloat(e);if(!isNaN(i)&&i!==1/0){var n=parseFloat(this.get("definition.min")),a=parseFloat(this.get("definition.max"));if(!(o.default.isNone(e)||o.default.isNone(t)||isNaN(i))){this.$().find(".uncertainty-range").addClass("ready"),this.set("data.text-value",i);var r=parseFloat(this.get("definition.uncertaintyRangeWidth")||1),s=i-r,l=i+r;isNaN(n)||(s=Math.max(n,s)),isNaN(a)||(l=Math.min(a,l)),this.set("uncertaintyRangeMin",s),this.set("uncertaintyRangeMax",l),t.slider("option","min",s),t.slider("option","max",l),t.slider("values",0,i-r/2),t.slider("values",1,i+r/2)}}}.observes("data.text","definition.uncertaintyRangeWidth"),rerenderIfAskForUncertaintyRangeChanges:function(){this.rerender()}.observes("definition.askForUncertaintyRange"),validate:function(e){var t=this.get("definition.validation");if(t&&!s.default.evalInScope(t,{answer:e}))return"Answer must be a"+this.get("definition.validationMessage")},serializeData:function(e,t){var i=this.get("data.text");if(i){var n=this.validate(i);n&&t.pushObject(n)}else t.pushObject("A text box is still blank");e.set("value",i),this.get("definition.askForUncertaintyRange")&&(e.set("uncertaintyRangeLower",this.get("data.uncertaintyRangeLower")),e.set("uncertaintyRangeUpper",this.get("data.uncertaintyRangeUpper")))}})},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t,i){var n=e.filter(function(e){return!e.fixedValue}),a=void 0;n.length>0&&(a=e[e.indexOf(n[0])-1],s.default.isNone(a)&&(a=e[0]));var o=v.create({name:i+"Max",title:"The maximuum value you can imagine",virtualSeries:!0,frame:t,color:"#ebb419",startingPoint:a,fillBetweenRelativePoints:!0});o.set("points",n.map(function(e){return w.create({relativeTo:e,relativeValueMin:0,series:o})}));var r=v.create({name:i+"Min",title:"The minimuum value you can imagine",virtualSeries:!0,frame:t,color:"#19ebb4",startingPoint:a,fillBetweenRelativePoints:!0});return r.set("points",n.map(function(e){return w.create({relativeTo:e,relativeValueMax:0,series:r})})),window.debugMax=o,window.debugPoints=e,{min:r,max:o}}function o(e){return Math.log(e)/Math.log(10)}var r=i(2),s=n(r),l=i(14),d=n(l),u=i(1),c=n(u),g=i(24),f=i(20),h=i(23),p=i(15),m=-15;p.WidgetResultsViewRegistry.TimeTrend=p.WidgetResultsView.extend({templateName:"time-trend-results",classNames:["widget-results","time-trend"],content:void 0,googleAvailable:!1,dataTableAndFriends:function(){var e=new google.visualization.DataTable;e.addColumn({type:"number",label:"Year",pattern:"####"});var t=(new s.default.Set,{}),i=this.get("allX").toArray().sort();e.addRows(i.get("length")),i.forEach(function(i,n){e.setCell(n,0,i,null),t[i]=n});var n=[],a={},o={},r={},l=new s.default.Set,d=new s.default.Set;this.get("perExpertData").forEach(function(i){var u=i.expertID,c=i.data;for(var g in c)if("metadata"!=g&&c.hasOwnProperty(g)){var f=!1,h=f?"interval":"data",p=e.addColumn({type:"number",label:g,role:h,pattern:"@@##"});n.push(p),s.default.isNone(a[g])&&(a[g]=[]),a[g].push(p),l.add(g),s.default.isNone(o[u])&&(o[u]=[]),o[u].push(p),d.add(u),r[p]=u;var m=c[g];m.forEach(function(i){var n=t[i.x];s.default.isNone(n)||e.setCell(n,p,i.y,null)})}});var u=new google.visualization.NumberFormat({pattern:"##.##"});return n.forEach(function(t){u.format(e,t)}),{dataTable:e,seriesNameToColumnNums:a,expertIDToColumnNums:o,columnNumToExpertID:r,seriesNames:l,expertIDs:d}}.property("allX","perExpertData"),didInsertElement:function(){this._super();var e=this.$("div.google-chart-holder"),t=this;google.load("visualization","1",{packages:["corechart"],callback:function(){var i=new google.visualization.LineChart(e.get(0)),n={pointSize:5,focusTarget:"datum",backgroundColor:"#707580",titlePosition:"none",vAxis:{viewWindowMode:"pretty",textStyle:{color:"white"},gridlines:{color:"#888"},baselineColor:"#707580"},tooltip:{trigger:"selection"},hAxis:{format:"####",viewWindowMode:"pretty",textStyle:{color:"white"},gridlines:{color:"#888"},baselineColor:"#707580"},theme:"maximized"},a=t.get("dataTableAndFriends"),o=["#19b5eb","rgb(217,76,116)","rgb(123,105,209)","rgb(235,136,35)","rgb(76,166,73)","rgb(64,133,198)","rgb(228,81,39)","rgb(90,86,196)","rgb(168,206,56)","rgb(255,205,5)","rgb(16,147,128)","rgb(154,61,168)"],r={};a.seriesNames.forEach(function(e){var t=o.shift(),i=!0;a.seriesNameToColumnNums[e].forEach(function(e){var n=e-1,a={color:t,visibleInLegend:!1};i&&(a.visibleInLegend=!0,i=!1),r[n]=a})}),n.series=r,i.draw(a.dataTable,n),debug.googleChart=i,debug.googleChartDataTable=a.dataTable,t.set("googleAvailable",!0),google.visualization.events.addListener(i,"onmouseover",function(e){if(null!=e.column){var t=e.column,n=a.columnNumToExpertID[t],o=a.expertIDToColumnNums[n],r=o.map(function(e){return{column:e}});i.setSelection(r)}})}})},expertIDs:function(){var e=this.get("content.perExpertData");return e.mapProperty("expertID").map(function(e){return e.toString()})}.property("content.perExpertData"),data:function(){var e=this.get("content.perExpertData");return debug.perExpertData=e,e.mapProperty("data")}.property("content.perExpertData"),seriesNames:function(){var e=this.get("data"),t=s.default.Set.create();return e.forEach(function(e){for(var i in e)e.hasOwnProperty(i)&&t.add(i)}),t.remove("metadata"),t.toArray()}.property("data"),series:function(){var e=this.get("data"),t=this.get("seriesNames"),i=function(e){return!s.default.isNone(e)},n={};return t.forEach(function(t){n[t]=e.mapProperty(t).filter(i)}),n}.property("data","seriesNames"),allPoints:function(){var e=this.get("series"),t=this.get("seriesNames"),i=[],n=function(e){e.forEach(function(e){i.push(e)})};return t.forEach(function(t){e[t].forEach(n)}),i}.property("series"),allX:function(){return new s.default.Set(this.get("allPoints").mapProperty("x"))}.property("allPoints"),allY:function(){return new s.default.Set(this.get("allPoints").mapProperty("y"))}.property("allPoints"),minX:function(){return Math.min.apply(Math,this.get("allX"))}.property("allX"),maxX:function(){return Math.max.apply(Math,this.get("allX"))}.property("allX"),minY:function(){return Math.min.apply(Math,this.get("allY"))}.property("allY"),maxY:function(){return Math.max.apply(Math,this.get("allY"))}.property("allY")}),d.default.TimeTrendPointView=s.default.View.extend({didInsertElement:function(){function e(e){return function(){e.apply(t,arguments)}}var t=this;this.get("point.fixedValue")||this.$().draggable({axis:"y",start:function(){t.set("frame.pointBeingDragged",t)},stop:function(e,i){t.updateModelFromCSS(e,i),t.set("frame.pointBeingDragged",null)},drag:e(this.updateModelFromCSS)}),this.colorChanged()},colorChanged:function(){this.$(".dot").css("background-color",this.get("point.color"))}.observes("point.color"),updateModelFromCSS:function(e,t){var i=this.get("frame"),n=this.get("point");n.setProperties({value:i.fromPixelY(t.position.top)}),i.notifyPropertyChange("pointsChanged")},classNames:["point"],classNameBindings:["point.fixedValue","point.isNextUndefinedPoint","point.isUndefined","point.draggingOutOfBounds"],templateName:"time-trend-point",attributeBindings:["style"],style:function(){var e=this.get("frame");if(!s.default.isNone(e)){window.debugFrame=e;var t,i=parseFloat(this.get("point.x")),n=parseFloat(this.get("point.y")),a=m;isNaN(n)||(a=e.toPixelY(n)),t=e.toPixelX(i);var o="top: "+a+"px; left: "+t+"px";return o}}.property("point.x","point.y","frame.coordsChanged")}),d.default.TimeTrendSeriesView=s.default.View.extend({classNameBindings:[":series","series.isVisible","series.isCurrentSeries","series.complete"],attributeBindings:["title"],titleBinding:"series.name"});var v=f.WidgetDefinition.extend({onInit:function(){this.set("points",s.default.A(this.get("points")))}.on("init"),color:"#19b4eb",name:void 0,startingPoint:void 0,points:void 0,reversePoints:function(){return this.get("points").copy().reverse()}.property("points"),virtualSeries:!1,isVisible:function(){return this.get("isComplete")||this.get("isCurrentSeries")}.property("isComplete","isCurrentSeries"),isComplete:function(){return s.default.isNone(this.get("nextUndefinedPoint"))}.property("points.@each.isUndefined"),nextUndefinedPoint:function(){return this.get("points").findProperty("isUndefined")}.property("points.@each.isUndefined"),frame:void 0,isCurrentSeries:function(){return this.get("frame.currentSeries")==this}.property("frame.currentSeries"),labelStyle:function(){return"color: "+this.get("color")}.property("color"),fillBetweenRelativePoints:!1}),y=["year","label","value","fixedValue","series"],b=f.WidgetDefinition.extend(s.default.Copyable,{copy:function(){return b.create(this.getProperties(y))},label:"",x:function(){return parseFloat(this.get("year"))}.property("year"),y:function(){return parseFloat(this.get("value"))}.property("value"),year:2012,value:1,fixedValue:!1,isAdjustable:function(){return!this.get("fixedValue")}.property("fixedValue"),series:void 0,isNextUndefinedPoint:function(){return this==this.get("series.nextUndefinedPoint")}.property("series","series.nextUndefinedPoint"),isUndefined:function(){return isNaN(parseFloat(this.get("year")))||isNaN(parseFloat(this.get("value")))}.property("year","value"),draggingOutOfBounds:!1,color:function(){return this.get("isAdjustable")?this.get("series.color"):"rgb(128,128,128)"}.property("series.color","isAdjustable")}),w=b.extend({relativeTo:void 0,relativeValueMin:void 0,relativeValueMax:void 0,relativeValue:void 0,yearBinding:"relativeTo.year",value:function(e,t){var i=this.get("relativeTo.y");if(arguments.length>1){var n=parseFloat(t)-i,a=!1,o=this.get("relativeValueMin");!s.default.isNone(o)&&n<o&&(n=o,a=!0);var r=this.get("relativeValueMax");!s.default.isNone(r)&&n>r&&(n=r,a=!0),this.set("draggingOutOfBounds",a),this.set("relativeValue",n)}return i+this.get("relativeValue")}.property("relativeValue","relativeTo","relativeTo.value")}),x=s.default.Object.extend({renderingUsingExCanvas:!1,widget:void 0,definitionBinding:"widget.definition",pointBeingDragged:null,aPointIsBeingDragged:function(){return!s.default.isNone(this.get("pointBeingDragged"))}.property("pointBeingDragged"),pointBeingDraggedYStatus:function(){var e=this.get("pointBeingDragged");if(s.default.isNone(e))return"";var t=e.get("point.y");this.get("modelRangeY");return parseFloat(t).toFixed(2)}.property("modelRangeY","pointBeingDragged.point.y"),theFrameIsBeingScaled:!1,series:function(){var e=s.default.A([]),t=this,i=v.create({name:this.get("definition.seriesLabel"),title:"The value you expect",frame:t}),n=this.get("definition.points").map(function(e){return s.default.copy(e).set("series",i)});if(i.set("points",n),e.push(i),this.get("definition.requestRange")){var o=a(n,t,"");e.push(o.max),e.push(o.min)}var r=["#ebb419","#98ef05","#f00098","#2349F0","#39F034"];return this.get("definition.series").forEach(function(i){var n=i.get("label"),o=v.create({name:n,title:"",frame:t,color:r.pop()}),l=i.get("points").map(function(e){return s.default.copy(e).set("series",o)});if(o.set("points",l),e.push(o),i.get("requestRange")){var d=a(l,t,n+" ");e.push(d.max),e.push(d.min)}}),e}.property("definition.seriesLabel","definition.points","definition.requestRange","definition.pointsChanged","definition.series.@each","definition.series.@each.pointsChanged","definition.series.@each.requestRange","definition.series.@each.label"),currentSeries:function(){return this.get("series").find(function(e){return!e.get("isComplete")})}.property("series.@each.isComplete"),dom:void 0,frameDOM:function(){return this.get("dom").find(".frame")}.property("dom"),axisCanvas:function(){return this.get("frameDOM").find("canvas").filter("#axis")[0]}.property("frameDOM").volatile(),linesCanvas:function(){return this.get("frameDOM").find("canvas").filter("#lines")[0]}.property("frameDOM").volatile(),minPixelX:20,maxPixelX:void 0,minPixelY:2,maxPixelY:void 0,minModelX:2e3,maxModelX:2030,minModelY:0,maxModelY:1.2,modelRangeHasBeenSet:!1,setModelRange:function(e){var t=parseFloat(this.get("definition.valueAxisMinUpperRange"));isNaN(t)||(e.maxModelY=Math.max(t,e.maxModelY));var i=parseFloat(this.get("definition.valueAxisMaxLowerRange"));isNaN(i)||(e.minModelY=Math.min(i,e.minModelY));var n=this,a=this.get("modelRangeHasBeenSet")&&!this.get("renderingUsingExCanvas");if(this.set("modelRangeHasBeenSet",!0),a){this.set("theFrameIsBeingScaled",!0);var o=this.getProperties("minModelX","maxModelX","minModelY","maxModelY");$(o).animate(e,{duration:1e3,step:function(){n.setProperties(this),n.notifyPropertyChange("coordsChanged")},complete:function(){n.set("theFrameIsBeingScaled",!1),n.setProperties(this),n.notifyPropertyChange("coordsChanged")}})}else n.setProperties(e),n.notifyPropertyChange("coordsChanged")},extremePointsChanged:function(){if(!this.get("aPointIsBeingDragged")){if(this.get("allPoints.length")<1)return void this.setModelRange({minModelX:0,maxModelX:10,minModelY:0,maxModelY:1});var e=this.get("minPointX"),t=this.get("maxPointX"),i=this.get("minPointY"),n=this.get("maxPointY");isNaN(e)&&(e=0),isNaN(t)&&(t=10),isNaN(i)&&(i=0),isNaN(n)&&(n=1);var a=t-e,o=n-i,r=.1*a,s=.2*o;e===t&&(r=4),i===n&&(s=4),this.setModelRange({minModelX:e-r,maxModelX:t+r,minModelY:i-s,maxModelY:n+2*s})}}.observes("minPointX","maxPointX","minPointY","maxPointY","aPointIsBeingDragged","definition.timeAxisLogBase","definition.valueAxisLogBase").on("init"),allPoints:function(){var e=this.get("series").reduce(function(e,t){return e.concat(t.get("points"))},[]);return s.default.A(e)}.property("pointsChanged","series"),mostExtremePoint:function(e){var t=void 0;return this.get("allPoints").forEach(function(i){(void 0==t||e(i,t))&&(t=i)}),t},minPointX:function(){return this.mostExtremePoint(function(e,t){return e.get("x")<t.get("x")}).get("x")}.property("allPoints","allPoints.@each.x"),minPointY:function(){return this.mostExtremePoint(function(e,t){return e.get("y")<t.get("y")}).get("y")}.property("allPoints","allPoints.@each.y"),maxPointX:function(){return this.mostExtremePoint(function(e,t){return e.get("x")>t.get("x")}).get("x")}.property("allPoints","allPoints.@each.x"),maxPointY:function(){return this.mostExtremePoint(function(e,t){return e.get("y")>t.get("y")}).get("y")}.property("allPoints","allPoints.@each.y"),pixelRangeX:function(){return this.get("maxPixelX")-this.get("minPixelX")}.property("minPixelX","maxPixelX"),pixelRangeY:function(){return this.get("minPixelY")-this.get("maxPixelY")}.property("minPixelY","maxPixelY"),modelRangeX:function(){return this.get("maxModelX")-this.get("minModelX")}.property("minModelX","maxModelX"),modelRangeY:function(){return this.get("maxModelY")-this.get("minModelY")}.property("minModelY","maxModelY"),coordsChanged:void 0,pointsChanged:void 0,scale:function(e,t){if(t>1){var i=e>=0?1:-1;return i*Math.log(Math.abs(e))/Math.log(t)}return e},fromPixel:function(e,t,i,n,a,o){var r=(e-t)/i,s=this.scale(n,o),l=this.scale(a,o)-s,d=r*l+s;return o>1?Math.pow(o,d):d},fromPixelX:function(e){return this.fromPixel(e,this.get("minPixelX"),this.get("pixelRangeX"),this.get("minModelX"),this.get("maxModelX"),parseFloat(this.get("definition.timeAxisLogBase")))},fromPixelY:function(e){return this.fromPixel(e,this.get("maxPixelY"),this.get("pixelRangeY"),this.get("minModelY"),this.get("maxModelY"),parseFloat(this.get("definition.valueAxisLogBase")))},toPixel:function(e,t,i,n,a,o){var r=this.scale(t,o)-this.scale(i,o),s=(this.scale(e,o)-this.scale(i,o))/r;return Math.round(s*n+a)},toPixelX:function(e){return this.toPixel(e,this.get("maxModelX"),this.get("minModelX"),this.get("pixelRangeX"),this.get("minPixelX"),parseFloat(this.get("definition.timeAxisLogBase")))},toPixelY:function(e){return this.toPixel(e,this.get("maxModelY"),this.get("minModelY"),this.get("pixelRangeY"),this.get("maxPixelY"),parseFloat(this.get("definition.valueAxisLogBase")))}}),P={type:"HasMany",prettyName:"Point",emphasizeWhenEmpty:!0,accessor:f.WidgetDefinition.HasMany("point",{model:b,year:{accessor:f.WidgetDefinition.Attr("year"),prettyName:"Year (X)"},value:{accessor:f.WidgetDefinition.Attr("value"),prettyName:"Default Value (Y)",helpText:"Leave blank to start with an undefined y-value (recommended)"},fixedValue:{accessor:f.WidgetDefinition.Attr("fixed-value"),type:"Boolean",prettyName:"Value isn't user adjustable",helpText:"The point is fixed at authoring time and experts cannot move it, e.g. use for historical or reference points."},label:{accessor:f.WidgetDefinition.Attr("label"),prettyName:"Label the point",helpText:"Add an annotation to the point"}})};g.Widget.register("time-trend",{prettyName:"Time Trend",templateName:"time-trend",widgetResults:p.WidgetResultsViewRegistry.TimeTrend,dataModel:h.WidgetData.extend({}),definitionSchema:{model:f.WidgetDefinition.extend({pointsChanged:void 0,informWhenPointsChange:function(){this.notifyPropertyChange("pointsChanged")}.observes("points.@each.year","points.@each.value","points.@each.fixedValue","points.@each.label"),valueAxisLabel:"Weight in Kg",seriesLabel:"Expected"}),label:{accessor:f.WidgetDefinition.ChildNode("label"),type:"Text"},requestRange:{accessor:f.WidgetDefinition.Attr("request-range"),prettyName:"Also request Min and Max series",type:"Boolean"},valueAxisLabel:{accessor:f.WidgetDefinition.Attr("value-axis-label"),prettyName:"Value (Y) Axis Label",type:"String"},timeAxisLabel:{accessor:f.WidgetDefinition.Attr("time-axis-label"),prettyName:"Time (X) Axis Label",type:"String"},seriesLabel:{accessor:f.WidgetDefinition.Attr("series-label"),prettyName:"Series Label",type:"String"},points:P,valueAxisMinUpperRange:{accessor:f.WidgetDefinition.Attr("value-axis-min-upper-range"),prettyName:"Min Upper",type:"String",category:"Y-Axis Range"},valueAxisMaxLowerRange:{accessor:f.WidgetDefinition.Attr("value-axis-max-lower-range"),prettyName:"Max Lower",type:"String",category:"Y-Axis Range"},valueAxisLogBase:{accessor:f.WidgetDefinition.Attr("value-axis-log-base"),prettyName:"Y-Axis Log Base",type:"String",category:"Y-Axis Range"},timeAxisLogBase:{accessor:f.WidgetDefinition.Attr("time-axis-log-base"),prettyName:"X-Axis Log Base",type:"String",category:"Y-Axis Range"},series:{type:"HasMany",prettyName:"Series",accessor:f.WidgetDefinition.HasMany("series",{model:f.WidgetDefinition.extend({label:"A Series",pointsChanged:void 0,informWhenPointsChange:function(){this.notifyPropertyChange("pointsChanged")}.observes("points.@each.year","points.@each.value","points.@each.fixedValue","points.@each.label")}),label:{accessor:f.WidgetDefinition.Attr("label"),prettyName:"Series Label"},points:P,requestRange:{accessor:f.WidgetDefinition.Attr("request-range"),prettyName:"Also request Min and Max series",type:"Boolean"}})}},initWidget:function(){this._super();var e=x.create({widget:this});this.set("frame",e),this.set("data.frame",e)},afterStateResume:function(){this.get("frame").notifyPropertyChange("pointsChanged")},serializeData:function(e,t){this.get("frame.series").forEach(function(i){var n=c.default.escapeForEmberProperty(i.get("name"));i.get("isComplete")||t.pushObject("Series '"+n+"' has undragged points"),e.set(n,i.get("points").filterProperty("isAdjustable").map(function(e){return e.getProperties("x","y")}))})},redraw:function(){var e=this.get("frame"),t=e.get("frameDOM"),i=(this.get("data"),this.get("definition"),t.find("canvas#axis")),n=i.get(0),a=n.width=i.width()||t.width(),o=n.height=i.height()||t.height(),r=t.find("canvas#lines"),s=r.get(0);s.width=r.width()||t.width(),s.height=r.height()||t.height(),e.setProperties({maxPixelX:a-60,maxPixelY:o-20}),e.notifyPropertyChange("coordsChanged")},frame:void 0,setupDOM:function(){if(this.set("frame.dom",this.$()),this.set("haveSetupDOM",!0),void 0!=window.G_vmlCanvasManager){var e=this.get("frame"),t=e.get("axisCanvas"),i=e.get("linesCanvas");t=c.default.recreateCanvasElement(t),i=c.default.recreateCanvasElement(i),window.G_vmlCanvasManager.initElement(t),window.G_vmlCanvasManager.initElement(i),e.set("renderingUsingExCanvas",!0)}this.redraw()},drawConnectingLines:function(){function e(e){var t=parseFloat(e.get("x"));return t=isNaN(t)?-15:n.toPixelX(t)}function t(e){var t=parseFloat(e.get("y"));return t=isNaN(t)?m:n.toPixelY(t)}var i=30,n=this.get("frame");if(!s.default.isNone(n)&&this.get("haveSetupDOM")){var a=n.get("linesCanvas"),o=a.getContext("2d"),r=this.get("frame.series");n.toPixelX(n.minModelX),n.toPixelY(n.minModelY),n.toPixelX(n.maxModelX),n.toPixelY(n.maxModelY);o.save(),o.clearRect(0,0,a.width,a.height),o.translate(0,i),r.forEach(function(i){if(i.get("isVisible")){o.beginPath();var n,a=void 0,r=!1,l=i.get("startingPoint");s.default.isNone(l)||(n=e(l),a=t(l)),i.get("points").forEach(function(s){var l=e(s),d=t(s),u=s.get("isUndefined");void 0!=n&&void 0!=a&&(s.get("isAdjustable")?(o.strokeStyle=i.get("color"),o.lineWidth=3):(o.strokeStyle="#333",o.lineWidth=2),o.beginPath(),u||r?(D(o,n,a,l,d),o.lineWidth=1):(o.moveTo(n,a),o.lineTo(l,d)),o.stroke()),n=l,a=d,r=u});var d=i.get("fillBetweenRelativePoints");if(!s.default.isNone(d)){s.default.isNone(l)||o.moveTo(e(l),t(l));var u=i.get("points").filterProperty("isUndefined",!1).filterProperty("relativeTo");u.forEach(function(i){o.lineTo(e(i),t(i))}),u.slice().reverse().mapProperty("relativeTo").forEach(function(i){s.default.isNone(i)||o.lineTo(e(i),t(i))}),o.fillStyle="rgba(255,255,0,0.2)",o.fill()}}}),o.restore()}}.observes("frame.coordsChanged","frame.pointsChanged"),drawGrid:function(e,t,i,n,a,r,s){var l="rgb(200,200,200)";e.save(),e.lineWidth=1,e.strokeStyle=l,e.textAlign="center",e.textBaseline="top",e.font="12pt Helvetica";var d=i-t,u=Math.round(o(d)),c=Math.pow(10,u),g=1,f=9,h=15;d/c<f&&(c/=10,u--),d/c<f&&(c/=2,u--),d/c>h&&(g*=2);for(var p=c*g,m=Math.round(t/p)*p,v=0,y=m;y<i;y+=c){var b=r(y),w=v>=g;w&&(v=0),v++,e.save();if(w){e.beginPath(),e.moveTo(b,n),e.lineTo(b,a),e.lineWidth=1,e.stroke(),e.save(),s(e,b,n);var x;x=u<1?y.toFixed(Math.abs(u)):y.toFixed(),e.fillText(x,0,5),e.restore()}e.restore()}e.restore()},drawAxis:function(){function e(e,t){return function(){return t.apply(e,arguments)}}var t=this.get("frame");if(!s.default.isNone(t)&&this.get("haveSetupDOM")){var i=t.get("axisCanvas"),n=i.getContext("2d");n.clearRect(0,0,i.width,i.height);var a="black",o=t.toPixelX(t.minModelX),r=t.toPixelY(t.minModelY),l=t.toPixelX(t.maxModelX),d=t.toPixelY(t.maxModelY),u=function(e,t,i){e.translate(t,i)};this.drawGrid(n,t.minModelX,t.maxModelX,r,d,e(t,t.toPixelX),u),n.save(),n.translate(l,0),n.rotate(Math.PI/2);var u=function(e,t,i){e.translate(t,i),e.rotate(-Math.PI/2),e.translate(20,-15)};this.drawGrid(n,t.minModelY,t.maxModelY,0,l-o,e(t,t.toPixelY),u),n.beginPath();var c=t.toPixelY(0);n.moveTo(c,0),n.lineTo(c,l-o),n.lineWidth=1,n.strokeStyle="rgb(64,64,64)",
n.stroke(),n.restore(),n.save(),n.strokeStyle=a,n.lineCap="round",n.lineWidth=2,n.beginPath(),n.moveTo(o,r),n.lineTo(l,r),n.lineTo(l,d),n.lineTo(o,d),n.closePath(),n.stroke();t.maxModelX,t.minModelX;n.restore()}}.observes("frame.coordsChanged")});var D=function(e,t,i,n,a,o){o||(o=[10,5]),e.save();var r=n-t,s=a-i,l=Math.sqrt(r*r+s*s),d=Math.atan2(s,r);e.translate(t,i),e.moveTo(0,0),e.rotate(d);var u=o.length,c=0,g=!0;for(t=0;l>t;)t+=o[c++%u],t>l&&(t=l),g?e.lineTo(t,0):e.moveTo(t,0),g=!g;e.restore()}},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=i(2),o=(n(a),i(16));n(o);BrowserDetection.msie&&BrowserDetection.version<9&&EAT.definitionDOMElements.forEach(function(e){console.log("Registering "+e),document.createElement(e)})},function(e,t,i){"use strict";i(46),i(52),i(86),i(88),i(90),i(97),i(99),i(101),i(103),i(105),i(107),i(109),i(111),i(113),i(115),i(117),i(119),i(121),i(123),i(125),i(127),i(129),i(131),i(133),i(135),i(138),i(140),i(142),i(144),i(146),i(148),i(150),i(152),i(154),i(156),i(158),i(160),i(162)},function(e,t){},,,,,,function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},,function(e,t){},,function(e,t){},,,,,,,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){}]);